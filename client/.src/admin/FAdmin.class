' Gambas class file
' Copyright (C) 2008,2009 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
'
' A Module for EasyGP to do adminstration task such as
'  administer recalls logged in the clinical section
'  perform staff tasks generated in the clinical section
'-----------------------------------------------------------------------

Private bexit As Boolean
Private cRequestMaintenance As Integer = 4
Private form_import_patients As FImportPatientsWizard
'Private form_import_coding As FImportCoding
Private form_global_preferences As FGlobalPreferences
Private form_developer_only As FDevelop 'only for richard's use
Private form_import_legacy As FImportLegacyData
Private form_room_setup As FRoomSetup
Private form_admin_requests As FAdminRequests
Private FPostcodes As FImportPostcodes

Public Sub form_Open()
  
  Init()
  
End

Public Sub Init()
  
   form_import_patients = New FImportPatientsWizard(Vbox_ImportPatients)
   'form_import_coding = New FImportCoding(Vbox_ImportCoding)
   form_import_legacy = New FImportLegacyData(Vbox_ImportLegacy)
   form_global_preferences = New FGlobalPreferences(Vbox_GlobalPreferences)
   form_room_setup = New FRoomSetup(Vbox_RoomSetup)
   form_developer_only = New FDevelop(Hbox_Danger)
  
   FPostcodes = New FImportPostcodes(Vbox_ImportPostcodes)
End

Public Sub form_Close()
   Settings_Save()
  
End


Public Sub Settings_Save()

       '  form_import_coding.Settings_Save()
         form_import_patients.Settings_Save()
         form_global_preferences.Settings_Save()
         form_import_legacy.Settings_Save()
         Try form_admin_requests.Settings_Save() 'may not be loaded
  
End

Private Sub Settings_Load()

  
End


Public Sub TabStrip1_Click()

  Select Case Tabstrip1.Index
    Case cRequestMaintenance
          If IsNull(form_admin_requests) Then
             form_admin_requests = New FAdminRequests(Vbox_Requests)
             With form_admin_requests
                  .Init()
             End With
          End If
  
  End Select

End
