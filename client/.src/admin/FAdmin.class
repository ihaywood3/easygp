' Gambas class file

Private bexit As Boolean
Private cRequestMaintenance As Integer = 4
Private cHL7Tools As Integer = 5
Private form_import_patients As FImportPatientsWizard

Private form_global_preferences As FGlobalPreferences
Private form_developer_only As FDevelop 'only for richard's use
Private form_import_legacy As FImportLegacyData
Private form_room_setup As FRoomSetup
Private form_admin_requests As FAdminRequests
Private FPostcodes As FImportPostcodes
Private form_HL7Management As FHL7Management

Public Sub form_Open()
   
   Init()
   
End

Public Sub Init()
   
   form_import_patients = New FImportPatientsWizard(Vbox_ImportPatients)
   
   form_import_legacy = New FImportLegacyData(Vbox_ImportLegacy)
   form_global_preferences = New FGlobalPreferences(Vbox_GlobalPreferences)
   form_room_setup = New FRoomSetup(Vbox_RoomSetup)
   form_developer_only = New FDevelop(HBox_danger)
   FPostcodes = New FImportPostcodes(Vbox_ImportPostcodes)

End

Public Sub form_Close()

   Settings_Save()
   
End

Public Sub Settings_Save()
   
   form_import_patients.Settings_Save()
   form_global_preferences.Settings_Save()
   form_import_legacy.Settings_Save()
   Try form_admin_requests.Settings_Save() 'may not be loaded
   Try form_HL7Management.Settings_Save()
   
End

Private Sub Settings_Load()
   
End

Public Sub TabStrip1_Click()
   
   Select Case Tabstrip1.Index
      Case cRequestMaintenance
         If IsNull(form_admin_requests) Then
            form_admin_requests = New FAdminRequests(Vbox_Requests)
            With form_admin_requests
               .Init()
            End With
         End If
      Case cHL7Tools
         If IsNull(form_HL7Management) Then
            With form_HL7Management = New FHL7Management(HBox_HL7Tools)
              .Init()
            End With
         Endif
   End Select
   
End
