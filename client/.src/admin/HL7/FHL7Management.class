' Gambas class file

' Copyright (C) 2008-2014 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.

'------------------------------------------------------------------------------------------
' PURPOSE        : Allow Admin to do stuff with HL7, e.g set up messaging provders
'                : 
' CALLED BY      : FAdmin loads this and initialises it by .Init()
' BUGS           : Please report bugs
' NOT IMPLEMENTED:
' SPECIAL NOTES  : 
'------------------------------------------------------------------------------------------

Private form_MissingFiles As FHL7FindMissingFiles
Private Form_HL7MessagePreferences As FHL7MessagePreferences
Private Const cMessagePreferences As Integer = 0
Private Const cMissingFiles As Integer = 1


Public Sub Init()
   '--------------------------------------------------------------------------------------------
   'When  the hl7 Management tab is clicked, the default tab is loaded - the message preferences
   'Other tabs are loaded 'just in time' when user clicks on the tab
   '--------------------------------------------------------------------------------------------
    With Form_HL7MessagePreferences = New FHL7MessagePreferences(Vbox_MessagePreferences)
      .Init()
    End With
End


Public Sub Settings_Save()
  
   Try form_MissingFiles.Settings_Save()
   Try Form_HL7MessagePreferences.Settings_Save()
   
End


Public Sub TabStrip1_Click()

   Select Case Last.index
     Case cMessagePreferences
     Case cMissingFiles
         If IsNull(form_MissingFiles) Then 
           With form_MissingFiles = New FHL7FindMissingFiles(Vbox_Findfiles)
                  .Init()
           End With
         End If
   
   End Select

End
