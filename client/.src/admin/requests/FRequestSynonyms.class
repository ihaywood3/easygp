' Gambas class file

Private UserNames As Collection
Private Username As Collection

Private SenderNames As Collection
Private senderName As Collection
Private fk_lu_request As Integer 
Private form_help As FHtmlViewer 

Public Sub Init()
   
   Settings_Load()
   form_help = New FHtmlViewer(Vbox_Help)
   form_help.Help_Show("request-synonyms.html")
   Reload()
   
End

Public Sub Reload()
   
   usernames = modInboxDBI.User_Names_With_Synonym_Get(Trim(txtFilterUserName.text))
   lvUsernames.Clear()
   cvwSenderNames.Clear()
   If usernames.count Then  
      For Each username In usernames
         lvUsernames.Add(username!pk_lu_request, username!user_request_name) 
      Next 
   Endif
   lvUsernames.MoveFirst()
   Try lvUserNames_Select()
   
End

Public Sub Settings_Save()
   
   Settings["Admin_MaintainSynonyms/HSplit_userNames.Layout"] = HSplit_userNames.Layout
   Settings["Admin_MaintainSynonyms/VSplit_Main.Layout"] = VSplit_Main.Layout
   
End

Private Sub Settings_Load()
   
   Try HSplit_userNames.Layout = Settings["Admin_MaintainSynonyms/HSplit_userNames.Layout"] 'FIXME currently form is not showing.
   Try Vsplit_Main.layout = Settings["Admin_MaintainSynonyms/VSplit_Main.Layout"] 
   
End

Public Sub lvUserNames_Select()
   
   lvUserNames.movecurrent()  'do not change to LAST
   fk_lu_request = lvUserNames.item.key
   SenderNames = modInboxDBI.User_Name_Get_Synonyms(fk_lu_request)
   cvwSenderNames.Clear
   For Each sendername In SenderNames
      cvwSenderNames.add(sendername!pk_lu_link_provider_user_requests, 0)
      cvwSenderNames[sendername!pk_lu_link_provider_user_requests][0] = sendername!provider_request_name
   Next
   SenderSynonym_Display() 
   
End

Public Sub txtFilterUserName_KeyRelease()
   
   Reload()
   
End

Public Sub cvwSenderNames_Menu()

   If Last.count Then mnuSenderSynonyms.Popup()

End
Public Sub mnuSenderSynonyms_Click()
   
  Select Case Last.tag
  Case "edit"
      SenderSynonym_Edit() 
  Case "delete"
       SenderSynonym_Delete() 
  End Select 
   
End

Public Sub SenderSynonym_Display() 
   cvwSenderNames.MoveCurrent()
   txtRequestName.text = SenderNames[cvwSenderNames.Item.Key]!provider_request_name
   If SenderNames[cvwSenderNames.Item.Key]!lateralisation = const.LateralityNone Then
         rbLateralityNone.value = True 
   Else
       rbLateralityBoth.value = True
   Endif
   
End

Public Sub SenderSynonym_Edit() 
   
   Vbox_EditArea_Outer.Enabled = True
   
End

Public Sub SenderSynonym_Delete()
   
   
   
End

Public Sub cvwSenderNames_Select()

   SenderSynonym_Display()

End
