' Gambas class file

Static Public account_number As String
Static Public bsb As String
Static Public account_name As String

Public Sub Form_Open()
   
  tbBSB.Text = bsb
  tbAcctName.Text = account_name
  tbAcctNum.Text = account_number 
   
End


Public Sub btnOK_Click()
   

   If Validate() Then 
     bsb = tbBSB.Text
     account_number = tbAcctNum.Text
     account_name = tbAcctName.Text
     Me.Close(True)
   Endif

End

Public Sub btnCancel_Click()

   Me.Close

End

Private Function Validate() As Boolean
   
   Dim re As RegExp
   Dim s As String
   
   s = Replace$(tbBSB.text, " ", "")
   s = Replace$(s, "-", "")
   re = New RegExp(s, "^[0-9]{6}$")
   If re.Offset = -1 Then
      Message.Error("BSB must be six digits")
      Return False
   Endif
   s = Replace$(tbAcctNum.Text, " ", "")
   s = Replace$(s, "-", "")
   re = New RegExp(s, "^[0-9]{4,10}$")
   If re.Offset = -1 Then
      Message.Error("Account number must be 5 to 10 digits")
      Return False
   Endif
   If Len(tbAcctName.Text) < 2 Then
      Message.Error("Must provide an account name")
      Return False
   Endif
   Return True
   
End

