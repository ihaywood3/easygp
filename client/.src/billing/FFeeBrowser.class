' Gambas class file

' Copyright (C) 2008-2016 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
'
' A class to display a searchable fee list and fee details in FProgressNoteEditor
' which is embedded in Flinical. Fee details/descriptions cannot be changed
'-------------------------------------------------------------------------------
Private form_fee_list As FSearchFeeList
Public from_fee_schedule As FFeeSchedule
Public obs As Observer

Public Sub _new()
   
   With form_fee_list = New FSearchFeeList(Vbox_FeeList)
      .Scheduled_Fees_Reload()
   End With
   With from_fee_schedule = New FFeeSchedule(VBox_Descriptors_Fees) 
      .Init("FProgressNoteEditor")
   End With
   HSplit1.Layout = Settings[Me.Name & "/HSplit1.Layout", modUtilGUI.HSplit([1, 3])]
   obs = New Observer(form_fee_list.gvwFeeScheduleItems) As "gvwFeeScheduleItems"
   Settings_Load  
End

Public Sub Settings_Load()
   
  HSplit1.Layout = Settings[Me.name & "/HSplit1.Layout", modUtilGUI.HSplit([1, 3])]
   
End

Public Sub HSplit1_Resize()
   
   modUtilGUI.Split_Save_Settings(Me.Name, Hsplit1)
   
End

Public Sub gvwFeeScheduleItems_Select()
   '----------------------------------------------------------------------
   'User has clicked on the gridview containing the list of scheduled fees
   '----------------------------------------------------------------------
   
   Dim sfi As Collection = form_fee_list.ScheduledFeeItems[form_fee_list.gvwFeeScheduleItems.row]
   
   With from_fee_schedule
      .Fee_Schedule_Item_Set(sfi)
      .Fee_Schedule_Item_Display()
   End With
   
End
