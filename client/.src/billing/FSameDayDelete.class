' Gambas class file

Private fk_invoice As Variant
Private smdcode As String

Public Sub Run() As Boolean

   Return Not Me.ShowModal()

End

' set the PK of the invoice we are deleting, this is all we need to know to do the delete
Public Sub SetInvoicePK(pk As Variant)
   
  fk_invoice = pk 
  smdcode = Null
  
End

Public Sub rbSMD_Click()
   
  smdcode = Last.Tag 
   
End



Public Sub btnOK_Click()

   If IsNull(smdcode) Then
      Message.Error("You need to select a reason. Other is acceptable", "OK")
   Else
      modBillingDBI.Same_Day_Delete(fk_invoice, smdcode)
      Me.Close(True)
   Endif


End

Public Sub btnCancel_Click()

   Me.Close

End

