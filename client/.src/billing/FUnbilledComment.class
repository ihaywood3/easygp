' Gambas class file

Private fk_appointment As Variant
Private CV As ColumnView
Private row_key As Integer

Public Sub Run() As Boolean
   
   Return Not Me.ShowModal()
   
End

Public Sub Init(fk_app As Variant, cvw As Columnview, the_key As Integer)
   
   fk_appointment = fk_app
   row_key = the_key 
   CV = cvw 
   
End

Public Sub btnOK_Click()

   CV[row_key][2] = Trim(txtcomment.text)
   If modDBConnect.update("clerical.bookings", Null, ["pk": fk_appointment, "comment_for_billing": Trim(txtcomment.text)]) Then
      modDBConnect.CommitTrans
      Me.Close(True)
   Else
      Message.Info("An error occurred trying to save the comment")
   Endif
   
   
   
End

Public Sub btnCancel_Click()
   
   Me.Close
   
End
