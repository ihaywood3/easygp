' Gambas class file

' Copyright (C) 2008-2013 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.

Private form_archive As FArchiveDocuments
Private Form_ManageRecalls As FRecallManagement
Private form_StaffTasks As FStaffTasks
Private form_toohardbasket As FScanningTooHardBasket
Private form_documentsimported As FDocumentsImported
Private form_contacts As FContacts
Private form_patients As FContactsPatients
Private form_record_visit As FRecordVisit
Private form_accountmanagement As FAccountManagement
Private form_Invoice As FRecordVisit
Private form_makeappointments As FMakeAppointments
Private Const ctab_Appointments As Integer = 0
Private Const cTab_Invoices As Integer = 1
Private Const cTab_Scanning As Integer = 2
Private Const cTab_Documents As Integer = 3
Private Const cTab_Recalls As Integer = 4
Private Const cTab_Patients As Integer = 5
Private Const Archive_current As Integer = 0
Private Const Archive_Legacy As Integer = 1
Static Private form_clerical As FClerical

Static Public Sub Get_Main_Tab_Index() As Integer
   
  Return form_clerical.TabStrip1.Index 
   
End


Public Sub Form_Open()
   
   form_clerical = Me   
   TabStrip1.index = 0
   
    With form_makeappointments = New FMakeAppointments(VBox_Appointments)
      .Init() 
   End With
  
End

Public Sub TabStrip1_Click()
   
   Select Case Last.Index
      Case ctab_Appointments
        FMakeAppointments.Refresh_Appointments_External()
      Case cTab_Invoices
      If IsNull(form_Invoice) Then
            With form_Invoice = New FRecordVisit(Vbox_Invoice) 
               .Init()
            End With 
         Endif
      Case cTab_Scanning
         If IsNull(form_archive)
            With form_archive = New FArchiveDocuments(VBox_Scanning)
               .Init()
            End With
         End If
      Case cTab_Documents
         If IsNull(form_documentsimported) Then  
            With form_documentsimported = New FDocumentsImported(VBox_Documents)
               .Init()
            End With
         End If
      Case cTab_Recalls
         If IsNull(Form_ManageRecalls) Then
            Form_ManageRecalls = New FRecallManagement(VBox_Recalls)
         Endif
      Case cTab_Patients
         If IsNull(form_patients) Then
           form_patients = New FContactsPatients(VBox_Patients)
         End If     
   End Select
   
End

Public Sub Form_Close()
   
   form_clerical = Null
   form_archive = Null
   Form_ManageRecalls = Null
   form_StaffTasks = Null
   form_toohardbasket = Null
   form_documentsimported = Null
   form_contacts = Null
   form_patients = Null
   form_record_visit = Null
   form_accountmanagement = Null
   form_Invoice = Null
   form_makeappointments = Null
   
End


Public Sub Settings_Save()
   
   Try form_archive.Settings_Save()
   Try form_documentsimported.Settings_Save()
   Try Form_ManageRecalls.Settings_Save()
   
End

Private Sub Settings_Load()
   
End


