' Gambas class file

' Copyright (C) 2008-2012 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.

Private form_archive As FArchiveDocuments
Private Form_ManageRecalls As FRecallManagement
Private form_StaffTasks As FStaffTasks
Private form_toohardbasket As FScanningTooHardBasket
Private form_documentsimported As FDocumentsImported
Private form_contacts As FContacts
Private form_patients As FContactsPatients
Private form_record_visit As FRecordVisit
Private form_accountmanagement As FAccountManagement
'Private form_appointments As FAppointments
Private form_feeschedule As FDescriptorsBrowser
Private form_Invoice As FRecordVisit
Private form_makeappointments As FMakeAppointments
Private Const ctab_Appointments As Integer = 0
Private Const cTab_Invoices As Integer = 1
'Private Const cTab_AccountManagement As Integer = 2
Private Const cTab_ScheduleFees As Integer = 2
Private Const cTab_Scanning As Integer = 3
Private Const cTab_Documents As Integer = 4
Private Const cTab_Recalls As Integer = 5

Private Const Archive_current As Integer = 0
Private Const Archive_Legacy As Integer = 1

Public Sub Form_Open()
   
   TabStrip1.index = 0
   ' If IsNull(form_appointments) Then
   '    With form_appointments = New FAppointments(Vbox_Appointments)
   '       .Init()
   '    End With 
    '
    With form_makeappointments = New FMakeAppointments(VBox_Appointments)
      .Init() 
   End With
  
End

Public Sub TabStrip1_Click()
   
   Select Case Last.Index
      Case cTab_Invoices
      If IsNull(form_Invoice) Then
            With form_Invoice = New FRecordVisit(Vbox_Invoice) 
               .Init()
            End With 
         Endif
    
      Case cTab_ScheduleFees
      If IsNull(form_feeschedule) Then
            With form_feeschedule = New FDescriptorsBrowser(Vbox_FeeSchedule)   
               .Init() 
            End With
         End If   
              
      Case cTab_Scanning
         If IsNull(form_archive)
            With form_archive = New FArchiveDocuments(VBox_Scanning)
               .Init()
            End With
         End If
      Case cTab_Documents
         If IsNull(form_documentsimported) Then  
            With form_documentsimported = New FDocumentsImported(VBox_Documents)
               .Init()
            End With
         End If
      ' Case cTab_AccountManagement
      '    If IsNull(form_accountmanagement) Then
      '       With form_accountmanagement = New FAccountManagement(Vbox_AccountManagement)
      '           '  .Init()
      '       End With
      '    Endif
      Case cTab_Recalls
         If IsNull(Form_ManageRecalls) Then
            Form_ManageRecalls = New FRecallManagement(VBox_Recalls)
         Endif
         
   End Select
   
End

Public Sub Settings_Save()
   
   Try form_archive.Settings_Save()
   Try form_documentsimported.Settings_Save()
   
   Try Form_ManageRecalls.Settings_Save()
   
End

Private Sub Settings_Load()
   
End
