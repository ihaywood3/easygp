' Gambas class file

' Copyright (C) 2008-2011 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.

Private form_archive As FArchiveDocuments
Private Form_ManageRecalls As FRecallManagement
Private form_StaffTasks As FStaffTasks
Private form_toohardbasket As FScanningTooHardBasket
Private form_documentsimported As FDocumentsImported
Private form_contacts As FContacts
Private form_patients As FContactsPatients
Private form_record_visit As FRecordVisit
Private form_appointments As FAppointments
Private form_feeschedule As FDescriptorsBrowser
Private Const ctab_Appointments As Integer = 0
Private Const ctab_billing As Integer = 1
Private Const cTab_Scanning As Integer = 2
Private Const cTab_Documents As Integer = 3
Private Const cTab_Patients As Integer = 4
Private Const cTab_Contacts As Integer = 5
Private Const cTab_Recalls As Integer = 6
Private Const cTab_FeeSchedule As Integer = 7

Private Const Archive_current As Integer = 0
Private Const Archive_Legacy As Integer = 1

Public Sub Form_Open()
   
   TabStrip1.index = 0
    If IsNull(form_appointments) Then
      With form_appointments = New FAppointments(Vbox_Appointments)
         .Init()
      End With 
    Endif
  ' TabStrip1_Click()
End

Public Sub TabStrip1_Click()
   
   Select Case Last.Index
         
      Case ctab_billing
         If IsNull(form_record_visit) Then
            With form_record_visit = New FRecordVisit(Vbox_Billing) 
               .Init()
            End With 
         Endif
      Case cTab_Scanning
         If IsNull(form_archive)
            With form_archive = New FArchiveDocuments(VBox_Scanning)
               .Init()
            End With
         End If
      Case cTab_Documents
         If IsNull(form_documentsimported) Then  
            With form_documentsimported = New FDocumentsImported(VBox_Documents)
               .Init()
            End With
         End If
      Case cTab_Patients  
         If IsNull(form_patients) Then
            form_patients = New FContactsPatients(Vbox_Patients)
         End If    
      Case cTab_Contacts
         If IsNull(form_contacts) Then
            form_contacts = New FContacts(VBox_Contacts)
         End If    
      Case cTab_Recalls
         If IsNull(Form_ManageRecalls) Then
            Form_ManageRecalls = New FRecallManagement(VBox_Recalls)
         Endif
      Case cTab_FeeSchedule
         If IsNull(form_feeschedule) Then
            With form_feeschedule = New FDescriptorsBrowser(Vbox_FeeSchedule)   
               .Init() 
            End With
         End If   
   End Select
   
End

Public Sub Settings_Save()
   
   Try form_archive.Settings_Save()
   Try form_documentsimported.Settings_Save()
   Try form_feeschedule.Settings_Save()
   
End

Private Sub Settings_Load()
   
End
