' Gambas class file

Private Vaccinations_Not_Reported As Collection

Public Sub Form_Open()
   
End

Public Sub Init()
   
   cvwVaccinations.Columns.count = 12
   With cvwVaccinations
      .Columns[0].Width = 200
      .Columns[0].text = "Surname"
      .Columns[1].Width = 150
      .Columns[1].text = "Firstname"
      .Columns[2].Width = 50
      .Columns[2].text = "Birthdate"
      .Columns[3].Width = 50
      .Columns[3].text = "Age"
      .Columns[4].Width = 50
      .Columns[4].text = "Medicare No."
      .Columns[5].Width = 10
      .Columns[5].text = "Ref."
      .Columns[6].Width = 150
      .Columns[6].text = "Schedule"
      .Columns[7].Width = 150
      .Columns[7].text = "brand"
      .Columns[8].Width = 100
      .Columns[8].text = "Consult Date"
      .Columns[9].Width = 75
      .Columns[9].text = "Date Given"
      .Columns[10].Width = 200
      .Columns[10].text = "Given By"
      .Columns[11].Width = 100
      .Columns[11].text = "Date Reported"
   End With
   
   Reload
   
End

Public Sub Reload()
   
   Dim vaccination As Collection
   Dim x As Integer
   
   Vaccinations_Not_Reported = modUtil.Copy_Collection_Keyed_Sequentially(modVaccinationDBI.Vaccinations_Reported_to_AIR(False))
   cvwVaccinations.clear   
   For Each Vaccination In Vaccinations_Not_Reported
      cvwVaccinations.Add(x, 0)
      cvwVaccinations[x][0] = Vaccination!surname
      cvwVaccinations[x][1] = Vaccination!firstname
      cvwVaccinations[x][2] = Format(Vaccination!birthdate, "dd/mm/yyyy")
      cvwVaccinations[x][3] = Vaccination!age_numeric
      cvwVaccinations[x][4] = Vaccination!medicare_number
      cvwVaccinations[x][5] = Vaccination!medicare_ref_number
      cvwVaccinations[x][6] = Vaccination!schedule
      cvwVaccinations[x][7] = Vaccination!brand 
      cvwVaccinations[x][8] = Format(Vaccination!consult_date, "dd/mm/yyyy")
      cvwVaccinations[x][9] = Vaccination!date_given
      cvwVaccinations[x][10] = Vaccination!staff_wholename
      Try cvwVaccinations[x][11] = Format(Vaccination!reported_to_air_date, "dd/mm/yyyy")
      Inc x
   Next
   
End

Public Sub ToolButton1_Click()

   Reload

End
