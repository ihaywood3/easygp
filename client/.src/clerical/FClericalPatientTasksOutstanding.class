' Gambas class file

Private Form_Patient_Tasks As FPatientTasks       'all outstanding tasks for the patient in a grid
Private currentconsult As CConsult
Private form_html_viewer As FHtmlViewer
Private hobs As Observer
Static Private Form_Clerical_Patient_tasks As FClericalPatientTasksOutstanding

Public Sub _new()
   
   With form_html_viewer = New FHtmlViewer(VBox_HTML_Viewer)     'Form to show html of hl7 received
      .tbWebBrowserPrint.Visible = True
      .tbWebBrowserZoomOut.visible = True
      .tbWebBrowserZoomIn.visible = True
   End With 
   With Form_Patient_Tasks = New FPatientTasks(Vbox_PatientTasks)
      .tbNew.Visible = False
      .tbSave.Visible = False
      .mnuStaffTasks.Enabled = False
      .Embedded_Form_Set("FClericalPatientTasksOutstanding")
   End With
   hobs = New Observer(FPatientTasks.gvTasks) As "gvTasks"
   Form_Clerical_Patient_tasks = Me  
   
End

Static Public Sub Show_Audit_Trail(shtml As String)
   
   Form_Clerical_Patient_tasks.TestHTML(shtml)
   
End

Public Sub TestHTML(sHtml As String)
   
   form_html_viewer.WebView1.HTML = shtml
   
End

Public Sub init(cons As CConsult)
   
   currentconsult = cons
   With Form_Patient_Tasks
      .Init(currentconsult)           'Get all patienet task items and display
   End With 
   With Form_Patient_Tasks.gvTasks
      .setfocus
      .row = 0
   End With
   Form_Patient_Tasks.gvTasks_Select()

End
