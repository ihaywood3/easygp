' Gambas class file

Private fk_appointment As Variant

Public Sub Run() As Boolean

   Return Not Me.ShowModal()

End

Public Sub Init(fka As Integer)
   
  fk_appointment = fka 
   
End

Public Sub btnOK_Click()

   If Trim(txtComment.text) = "" Or fk_appointment = 0 Then Return
   If modDBConnect.update("clerical.bookings", Null, ["pk": fk_appointment, "appointment_specific_memo": Trim(txtComment.text)]) Then
      modDBConnect.CommitTrans()
   Endif
   
   Me.Close(True)

End

Public Sub btnCancel_Click()

   Me.Close

End

