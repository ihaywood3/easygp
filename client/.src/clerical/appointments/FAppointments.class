' Gambas class file

' Gambas class file
' Copyright (C) 2008-2011 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
'
' A Form Template for most other new forms
' Copy this form and paste as a new form
'----------------------------------------------------------------------

Private bexit As Boolean
Private OnRow As Integer
Public Sub form_Open()
  
  Init()
  
End

Public Sub Init()
  ' 
  ' With columnview1
  '   .Columns.Count = 2
  '   .Columns[0].width = 100
  '   .add(0, 0)
  '   ColumnView1[0][0] = "01/10/20011" 
  ' End With
  Dim Appointment_interval As Integer

  Dim x As Integer
  Dim iHour As Integer
  Dim iMinute As Integer
  Dim iStartHour As Integer = 8
  Dim iStartMinute As Integer = 30
  TextBox1.height = 25
  
  Print Format(Time(8, 30, 0), "hh:nn")
  
    Appointment_interval = 10
  
  With gridview1
    .Columns.count = 2
    .Rows.count = 100
  
   
  End With
  iHour = istarthour
  iminute = iStartMinute
  gridview1.Rows.H = 20
  For x = 0 To 50
     gridview1[x, 0].text = Format(Time(iHour, iminute, 0), "hh:nn") 
   '   Print Format(Time(iHour, iminute, 0), "hh:nn")
      iminute += 10
      Print iminute
      
      If iminute = 60 Then
        Inc iHour
        iMinute = 0
         
      Endif
  Next
  
 ' gridview1.row = 0
 ' gridview1.
End

Public Sub form_Close()
  
   Settings_Save()
  
End


Private Sub Settings_Save()


  

End

Private Sub Settings_Load()


  

End


Public Sub GridView1_DblClick()
 Dim iLeft As Integer
 Dim iTop As Integer
 

 Print gridview1.Rows.height 
 onrow = gridview1.Row
 iLeft = gridview1[0, 1].Left
 iTop = onrow * gridview1.Rows.height 
 
 TextBox1.left = iLeft
 TextBox1.top = iTop
 TextBox1.Visible = True
 TextBox1.SetFocus()
' gridview1.Rows[3].height = 50
End

Public Sub GridView1_Click()

  ' TextBox1.Visible = False   

End

Public Sub GridView1_Select()

   TextBox1.Visible = False   

End

Public Sub Textbox1_Activate()
   
   gridview1[onrow, 1].text = TextBox1.Text
   TextBox1.Visible = False   
   
   
End
