' Gambas class file

Private num_appt As Integer
Private weekly As Integer
Private data As Collection
Private start_date As Date
Private appt_time As String

Public Sub Init(data2 As Collection, start_date2 As Date, appt_time2 As String)

   data = data2
   start_date = start_date2
   appt_time = appt_time2

End


Public Sub Run() As Boolean

   Return Me.ShowModal()

End

Public Sub btnOK_Click()

   Inc Application.Busy  
   If rbWeekly.Value Then weekly = const.Units_week
   If rbFortnight.Value Then weekly = const.Units_fortnight 
   If rbMonthly.Value Then weekly = const.Units_month
   modAppointmentsDBI.Make_Recurring_Appointments(data, start_date, appt_time, sbAppts.Value, weekly)
   modDBConnect.CommitTrans()
   Dec Application.Busy
   Me.Close(True)

End

Public Sub btnCancel_Click()

   Me.Close(False)

End

