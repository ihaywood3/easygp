' Gambas class file

Private Intervals As Integer[]
Private gridrows As Collection
Private griddata As Collection
Private irowheight As Integer = 18

Public Sub Init(sWeekDay As String)

   lblWeekday.text = sWeekDay
   cmbIntervals.add("5 minutes")
   cmbIntervals.add("10 minutes")  
   cmbIntervals.add("15 minutes")
   cmbIntervals.add("20 minutes")
   cmbIntervals.add("30 minutes")
   cmbIntervals.add("45 minutes")
   cmbIntervals.add("60 minutes")
   Intervals = [5, 10, 15, 20, 30, 45, 60]
End
Public Sub cmbIntervals_Click()
  Show_Intervals(Intervals[cmbIntervals.Index])
   
End


Public Sub Show_Intervals(appointment_interval As Integer)
   '------------------------------------------------
   'initialise the appointment module from fclerical 
   '------------------------------------------------
   
   Dim x As Integer
   Dim ihour As Integer
   Dim iminute As Integer
   Dim istarthour As Integer = 8                                                       'fixme make me configurable
   Dim istartminute As Integer = 30
   
   Print "DB1.value:", DateBox1.Value
   istartminute = Minute(DateBox1.Value)
   istarthour = Hour(DateBox1.Value)
   With gridview1     
      .Clear()                                                                    
      .columns.count = 2
      .columns[0].width = 50
    '  .columns[1].width = 24
   '   .columns[1].width = gridview1.width - 100
      .rows.count = 50
   End With
   ihour = istarthour
   iminute = istartminute
   gridrows = New Collection
   
   For x = 0 To 49
      griddata = New Collection
      griddata!time = Format(Time(ihour, iminute, 0), "hh:nn")
      griddata!slots = 1
      gridrows.add(griddata, Str(x))
      gridview1[x, 0].text = Format(Time(ihour, iminute, 0), "hh:nn") 
      gridview1.rows[x].height = griddata!slots * irowheight
      iminute += appointment_interval
      Print iminute
      
      If iminute = 60 Then
         Inc ihour
         iminute = 0
         
      Endif
   Next
   
End

Public Sub DateBox1_DblClick()

   Print Last.value

End

Public Sub Gridview1_Menu()

   mnuSchedule.popup()

End


Public Sub DateBox2_Change()
   
    Print "you changed me"
End


Public Sub DateBox2_Click()

   Print "you dblclicked me but i'm in the click_event"
  Print Last.value
End
