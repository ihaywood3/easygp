' Gambas class file

' allows admin user to edit and change clinician sessions
' Copyright (C) 2011 Dr. Richard Terry, Dr. Ian Haywood

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.

Private weeknames As String[]


Public Sub Init()
   
  Dim staff As Collection
  Dim i As Collection
   
   weeknames = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"]
   staff = modContactsDBI.Staff_Get() 
  For Each i In staff
    lvStaff.Add(i!fk_staff, i!wholename)
  Next 
   
End

Public Sub btnNew_Click()

   

End

Public Sub btnSave_Click()

   

End

Public Sub btnDelete_Click()

   

End

Public Sub lvSessions_MClick()

   

End

Public Sub lvStaff_Click()

   Dim sessions As Collection
   Dim i As Crow
   Dim session_text As String
   
   lvStaff.MoveCurrent()
   Debug lvStaff.Item.Key
   Let sessions = modAppointmentsDBI.Sessions_List(lvStaff.Item.Key)
   For Each i In sessions
     session_text = Format$(i!begin, "hh:nn")
     session_text &= " - " & Format$(i!finish, "hh:nn")
     session_text &= " " & weeknames[i!weekday]
     lvSessions.Add(i!pk, session_text)
   Next
End
