' Gambas class file
' Copyright (C) 2008,2009 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
'
' A module for administering logged recalls
'----------------------------------------------------------------------
Private recalls_due As Collection
Private bexit As Boolean

Public Sub form_Open()
  
  Init()
  
End

Public Sub Init()
   With cvwRecallsDue
     .columns.count = 10
     .Columns[0].Text = "Date Due"
     .Columns[1].Text = "Firstname"
     .Columns[2].Text = "Surname"
     .Columns[3].Text = "Street"
     .Columns[4].Text = "suburb"
     .Columns[5].Text = "Phone"
     .Columns[6].Text = "Reason"
     .Columns[7].Text = "Urgency"
     .Columns[8].Text = "Contact by"
  
   End With
   recalls_due = modRecallsDBI.Recalls_Get()
   cvwRecalls_Refresh
End

Public Sub cvwRecalls_Refresh()
      Dim x As Integer
      Dim recall As Collection
      
      For Each recall In recalls_due
         x = recall!pk_recall
         cvwRecallsDue.add(x, 0)
         cvwRecallsDue[x][0] = Format(recall!due, "dd/mm/yyyy")
         cvwRecallsDue[x][1] = recall!firstname
         cvwRecallsDue[x][2] = recall!surname
         cvwRecallsDue[x][3] = "street here"
         cvwRecallsDue[x][4] = "suburb here"
         cvwRecallsDue[x][5] = "phone here"
         cvwRecallsDue[x][6] = recall!reason
         cvwRecallsDue[x][7] = recall!urgency
         cvwRecallsDue[x][8] = recall!contact_by
 
      Next
    
  
End

Public Sub form_Close()
  
   Settings_Save()
  
End


Private Sub Settings_Save()


  

End

Private Sub Settings_Load()


  

End

Public Sub mnuRecallManagement_Click()
  
  Select Case Last.tag
   Case "opportunistic"
   Case "arrange by phone"
   Case "print for mailing"
   Case "view archived"
   Case "refused"
   Case "refused with explanation"
   Case "completed"
   Case "completed with explanation"
   Case "delete with explanation"
   Case "change font"
   Case "help"
    
  End Select
  
End

Public Sub cvwRecallsDue_Menu()

  mnuRecallManagement.Popup()

End
