' Gambas class file

Private Staff As Collection

Public Sub Init()
   
   With tableview1
      .Columns.Count = 7
      .Rows.count = 10
      .Columns[0].text = "Date"
      .Columns[1].text = "Logged By"
      .Columns[2].text = "Issue"
      .Columns[3].text = "Proposed Action"
      .Columns[4].text = "Responsible Person"
      .Columns[5].text = "Outcome"
      .Columns[6].text = "Resolved"
      .Rows.H = 32
   End With
   lblMeasure.text = "Notes on Actioning   "
   modEditAreaHelpers.Resize_labels(Vbox_EditArea_Left, lblmeasure) 
   lblMeasure.text = "Proposed Actions   "
   modEditAreaHelpers.Resize_labels(VBox_EditArea_Right, lblmeasure)
   staff = modUtilGUI.LoadCombo(cmbStaff, modContactsDBI.Staff_Get(), "wholename")   
   Settings_Load 
   
End

Private Sub Form_Close()
   
   Settings_Save 
   
End

Private Sub Settings_Load()

   VSplit_Agenda_Items.Layout = Settings["FStaffMeetings/VSplit_Agenda_Items.Layout", modUtilGUI.VSplit([1, 1])]
 
End

Private Sub Settings_Save()
   
End

Public Sub EditArea_Buttons_Click()
   
   Select Case Last.tag
      Case "new issue"
         Issue_New 
      Case "save issue"
         Issue_Save
   End Select
   
End

Private Sub Issue_New()
   
   ' txtDateAgendaItemLogged.text = Format(Now, "dd/mm/yyyy")
   ' txtStaffLogged.text = modDBConnect.currentUser!wholename
   ' txtIssue.SetFocus   
   tableview1[0, 0].text = Format(Now, "dd/mm/yyyy")
   tableview1[0, 1].text = modDBConnect.currentUser!wholename

End 

Private Sub Issue_Save()
   '-----------------------------------------------------------------
   'Saves a user-entered issue to be raised at the next staff meeting
   '-----------------------------------------------------------------
   
   If Vbox_EditArea_Left_Outer.padding = 0 Then Return
   If Not Issue_Data_Is_Valid() Then Return
   
End

Private Sub Issue_Data_Is_Valid() As Boolean
   
   If Trim(txtIssue.text) = "" Then Return 
   Return True   
   
End

Public Sub EditArea_TxtBox_Change()
   
   Select Case Last.tag
      Case "issue"
         Vbox_EditArea_Left_Outer.Padding = 1
   End Select
   
End

Public Sub TableView1_Click()
   
   Select Case tableview1.Column
      Case 4
         tableview1.EditWith(cmbStaff)
      Case 6
         tableview1.EditWith(CheckBox1)
      Case Else
         tableview1.EditWith(textedit1)
   End Select
   
   ' Select Case tableview1.Column
   '    Case 0
   '       textedit
   '    Case 1
   ' End Select
End

Public Sub Tableview1_Save(Row As Integer, Column As Integer, Value As String) 
   
   ' If column <> 0 Then 
   Tableview1[Row, Column].text = Trim(Value)
   ' ProvidersOfCare[row]!contribution_to_plan = modUtilGUI.Strip_Last_Character(Trim(value), True)
   '  EditArea_Notify_DataChange(True)
   '  End If 
   
End


Public Sub VSplit_Agenda_Items_Resize()

   Settings[Me.name & "/VSplit_Agenda_Items.Layout"] = VSplit_Agenda_Items.Layout

End
