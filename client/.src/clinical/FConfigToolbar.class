' Gambas class file

Public Sub Run() As Boolean

  
  'Return Not Me.ShowModal()
 
End

Public Sub _new()
  
   Init()
  
End

Public Sub Init()
  
    Dim TBOption As CToolBarConfig
    Dim module As Collection
    Dim modules As Collection 
    modules = modAdminDBI.Clinical_Modules_Get_Names()
    
    Me.Title = "Configure Clinical Toolbar"
    
    For Each module In modAdminDBI.Clinical_Modules_Get_Names()
      With TBOption = New CToolBarConfig(ScrollView1, module!name, module!icon_path) As "ToolButton"
         .tag = module!name
      End With
    Next
   '  
   ' With TBOption = New CToolBarConfig(ScrollView1, "Requests", "icons/16/bloodtube16x16.png") As "ToolButton"
   '  .tag = "Requests"
   ' End With
   ' With TBOption = New CToolBarConfig(ScrollView1, "Recalls", "icons/16/boomerang1616.png") As "ToolButton"
   '  .tag = "Recalls"
   ' End With
   '  With TBOption = New CToolBarConfig(ScrollView1, "Referrals", "icons/16/referrals_3_1616.png") As "ToolButton"
   '  .tag = "Recalls"
   ' End With
   ' 
   ' With TBOption = New CToolBarConfig(ScrollView1, "Prescribe", "icons/20/prescribe.png") As "ToolButton"
   '  .tag = "Recalls"
   ' End With
   ' 
   ' With TBOption = New CToolBarConfig(ScrollView1, "Past History", "icons/20/past_history_2020.png") As "ToolButton"
   '  .tag = "Past History"
   ' End With
   ' With TBOption = New CToolBarConfig(ScrollView1, "Pregnancy", "icons/20/pregnancy.png") As "ToolButton"
   '  .tag = "Past History"
   ' End With
   ' With TBOption = New CToolBarConfig(ScrollView1, "Travel", "icons/16/airplane.png") As "ToolButton"
   '  .tag = "Past History"
   ' End With
   ' With TBOption = New CToolBarConfig(ScrollView1, "Vaccination", "icons/16/vaccination_1616.png") As "Toolbutton"
   '  .tag = "Past History"
   ' End With
   ' 
   ' With TBOption = New CToolBarConfig(ScrollView1, "Work Cover", "icons/20/workcover2020.png") As "ToolButton"
   '  .tag = "Work Cover"
   ' End With
   ' 
End

Public Sub ToolButton_MouseDrag()
  Dim pic As Picture
  Dim Module_Properties As New Collection
  Dim v As Variant
  Module_Properties!module = Last.tag
  Module_Properties!icon = Last.$hImage 
  
  pic = Picture.Load("icons/20/workcover2020.png")
  Drag.Icon = Last.$hImage.Picture 
'  Drag(Last.$hImage.Picture)
  Try Drag(Last.$hpanel, "data")
 ' Last.Drag("testing")
End 
Public Sub btnOK_Click()

  Me.Close(True)

End

Public Sub btnCancel_Click()

  Me.Close

End


