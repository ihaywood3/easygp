' Gambas class file

' Copyright (C) 2008-2016 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>
'----------------------------------------------------------------------
' PURPOSE   A modal dialog to confirm patient's identity 
'           currently only shows if a patient image exists
'           A put this in because the commonest thing I do wrong with
'           electronic records is type into the wrong patient's notes!
' TODO'S    Pull this up for all patients
'           put an aquire photo button on here
'---------------------------------------------------------------------
Public Sub Run() As Boolean
   
   Return Not Me.ShowModal()
   
End

Public Sub Form_Close()
   
   Inc Application.Busy 
   
End

Public Sub Init(P As Picture, Patient As Collection)
   
   Dec Application.Busy
   Me.title = "Confirm"
   label1.text = Patient!wholename
   picturebox1.Picture = P
   If patient!language_problems Then
      tlMemoLanguageAppointment.text = modConsultDBI.Warning_Language_Problems(Patient)
   End If
   If Not IsNull(patient!appointment_memo) Then
      tlMemoLanguageAppointment.text &= "<P ALIGN='center'><B>Appointment Memo</B></P>"
      tlMemoLanguageAppointment.text &= patient!appointment_memo
   End If  
   tlMemoLanguageAppointment.Visible = True  

End

Public Sub btnOK_Click()
   
   Me.Close(True)
   
End

Public Sub btnCancel_Click()
   
   Me.Close
   
End
