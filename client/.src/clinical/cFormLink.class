' Gambas class file
' Copyright (C) 2010 Dr. Ian Haywood

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.

Inherits CLink

' so these must be public so descendants can access them
' other classes shouldn't be accessing them
Public currentpatient As Collection
Public row As Collection
Public currentconsult As CConsult
Private form_class As String
Private myform As Form

Public Function IsDirty() As Boolean
  
  ' return True if the link is 'dirty', that is needs to be reloaded when exposed
  Return True
  
End

Public Sub _new(form_class2 As String, consult As CConsult, setrow As Collection)
   ' patient is the patient associated with this link
   ' consult is the current consult
   ' setrow is the specific 'thing': drug, request, referral etc
   ' that is being viewed/edited

   row = setrow
   currentconsult = consult
   form_class = form_class2
   
End

Public Function MakeForm(parent As Control) As Form
  
  myform = New (form_class, parent) As "MyForm"
  Object.Call(myform, "Init", [currentconsult, row])
  Return myform
  
End
