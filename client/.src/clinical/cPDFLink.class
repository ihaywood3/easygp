' Gambas class file

' Copyright (C) 2010-2014 Dr. Ian Haywood

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.

Inherits CWebLink
Private stored_pdfname As String

Public Function LinkType() As String
  
  Return 2
  
End

Public Function MakePDFFromHTML(sHtml As String) As String

' a utility function to create PDF from HTML, using wkhtmltopdf
   Dim pdfname As String
   pdfname = Temp$("html2pdf") & ".pdf"
   Inc Application.Busy 
   Shell "wkhtmltopdf " & modUtil.Write_HTML(sHtml, "html") & " " & pdfname Wait
   Dec Application.Busy
   stored_pdfname = pdfname
   Return pdfname
   
End

Public Function MakePDFFromLaTeX(latex As String) As String
  
  ' utility function to create PDF from latex
    
  Dim stem As String
  Dim f As File
  Dim cmd As String

  Inc Application.Busy  
  stem = Temp$("ltx2pdf")
  
  f = Open stem & ".tex" For Write Create
  Print #f, latex
  Close #f
  cmd = "cd `dirname " & stem & "` ; " 
  cmd &= "pdflatex ltx2pdf.tmp.tex ; "
  Shell cmd
  Dec Application.Busy
  stored_pdfname = stem & ".pdf"
  Return stored_pdfname
End


Public Sub Print()
  
  
  
End
