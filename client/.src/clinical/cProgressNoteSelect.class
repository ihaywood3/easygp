' Gambas class file

' cProgressNoteSelect
' Copyright (C) 2008-2016 Dr. Richard Terry
' class to construct a control containing a single progress note 
' and a checkbox used when exporting patients notes
'
' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.
'
' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
'------------------------------------------------------------------------------
Private cbSelectNote As CheckBox
Private $hbox As HBox
Private $HBox_checkbox As HBox
Private $PictureBox As PictureBox
Private $PnlSpacer As Panel
Private $TextLabel As TextLabel

Event Click()

Public Sub _new(hContainer As Vbox, ProgressNote As Collection)
        
   '---------------------------------------------------------------
   'This is the main 'container' holding the checkbox and the notes
   '---------------------------------------------------------------
   With $hbox = New HBox(hContainer)
      .Mouse = Mouse.Pointing
      .expand = False
      .padding = 3
      .AutoResize = True  
 '     .height = 80
      .tag = ProgressNote!pk_progressnote
   End With

   With $HBox_checkbox = New HBox($hbox)
      .width = 72
      .name = "HBox_CheckBox"
      .expand = False   
      .Background = Color.White
      .padding = 1
   End With
   '--------------------------------------------------------------------------------------
   '
   '--------------------------------------------------------------------------------------
   With cbSelectNote = New CheckBox($HBox_checkbox)
      .width = 50
      .Height = 50
      .Expand = False
   End With
   '-----------------------------------------------------
   'put a spacer between the picture and the next control
   '-----------------------------------------------------
   With $PnlSpacer = New Panel($hbox)
      .width = 50 
   End With
   '---------------------------------------------------------------------
   'Now the text showing patient's name/address/contact phone numbers etc
   '---------------------------------------------------------------------
   With $TextLabel = New TextLabel($Hbox) As "Text_Label"
      .Expand = True 
      .AutoResize = True  
      .font = Application.Font
      .text = ProgressNote!notes
     
   End With
End

Private Function Get_txt_label() As TextLabel
   
   Dim htxtLabel As TextLabel
   
   Try htxtLabel = Last
  
   
   Return htxtLabel
   ' 
End



Public Sub Text_Label_MouseUp()
   
   Dim htxtLabel As TextLabel
   Dim X As Integer
   Dim Y As Integer
   
   htxtLabel = Get_txt_label()
   
   
   X = Mouse.X
   Y = Mouse.Y
   
   If Last <> htxtLabel Then
      X = X + Last.X
      Y = Y + Last.Y
   Endif
   If (X >= 0 And Y >= 0 And X < htxtLabel.W And Y < htxtLabel.H) Then
      Raise Click()
      
   Else
      
   Endif
   
End

