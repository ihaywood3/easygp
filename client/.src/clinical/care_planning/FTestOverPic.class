' Gambas class file

Private CurrentConsult As CConsult

Public Sub Init(Cons As CConsult)
   Currentconsult = Cons
End

Public Sub Button1_Click()
 
  
   Dim templ As New CTemplate("epc-form1", "tex")
   
   templ.Subst_common(currentconsult)
   templ.Subst("postcode", "\\relax")
   templ.Subst("pdf_path", modUtil.Find_File("templates" &/ "epc_referral.pdf"))
   If chkGPMP.Value = True Then
     templ.Subst("Has_GPMP_and_TCA", "X")
   Else
        templ.Subst("Has_GPMP_and_TCA", "\\relax")
   Endif
   If chkMDCP.value = True Then
     templ.Subst("Multi_disciplinary_care_plan_aged_care", "X")
   Else
      templ.Subst("Multi_disciplinary_care_plan_aged_care", "\\relax")
   Endif
   Print templ.GetData()
   modPrinting.Print_latex(templ.GetData())

End
