' Gambas class file

Private CurrentConsult As CConsult

Public Sub Init(Cons As CConsult)

   Currentconsult = Cons

End

Public Sub Button1_Click()
   
   Dim templ As New CTemplate("epc-form1", "tex")
   
   templ.Subst_common(currentconsult)
   templ.Subst("postcode", "\\relax")
   templ.Subst("pdf_path", modUtil.Find_File("templates" &/ "epc_referral.pdf"))
   If chkGPMP.Value = True Then
      templ.Subst("Has_GPMP_and_TCA", "X")
   Else
      templ.Subst("Has_GPMP_and_TCA", "\\relax")
   Endif
   If chkMDCP.value = True Then
      templ.Subst("Multi_disciplinary_care_plan_aged_care", "X")
   Else
      templ.Subst("Multi_disciplinary_care_plan_aged_care", "\\relax")
   Endif
   Print templ.GetData()
   modPrinting.Print_latex(templ.GetData())
   
End

Public Sub Button2_Click()
   
   Dim templ As New CTemplate("nswwcpage1", "tex")
   Dim mcn As New String[]
   Dim x As Integer
   Dim birthdate As String
   Dim certificatedate As String = Format(Now(), "dd/mm/yyyy")
   Dim statedinjurydate As String = "01/02/2010"
   Dim firstseendate As String = "02/03/2011"
   If IsNull(currentconsult!patient!medicare_number) Then 
      currentconsult!patient!medicare_number = "0000000000" 'FIXME PUT THIS IN UNTIL REPAT STUFF SORTED
   End If   
   ' Error.Raise("Medicare number can't be NULL here")
   If IsNull(currentconsult!patient!birthdate) Then
      currentconsult!patient!birthdate = "00/00/0000"
   Endif
   birthdate = Format(currentconsult!patient!birthdate, "dd/mm/yyyy")
   templ.Subst("DOB1", Mid$(birthdate, 1, 1))
   templ.Subst("DOB2", Mid$(birthdate, 2, 1))
   templ.Subst("DOB3", Mid$(birthdate, 4, 1))
   templ.Subst("DOB4", Mid$(birthdate, 5, 1))
   templ.Subst("DOB5", Mid$(birthdate, 7, 1))
   templ.Subst("DOB6", Mid$(birthdate, 8, 1))
   templ.Subst("DOB7", Mid$(birthdate, 9, 1))
   templ.Subst("DOB8", Mid$(birthdate, 10, 1))
   templ.Subst("MA1", Mid$(currentconsult!patient!medicare_number, 1, 1))
   templ.Subst("MA2", Mid$(currentconsult!patient!medicare_number, 2, 1))
   templ.Subst("MA3", Mid$(currentconsult!patient!medicare_number, 3, 1))
   templ.Subst("MA4", Mid$(currentconsult!patient!medicare_number, 4, 1))
   templ.Subst("MA5", Mid$(currentconsult!patient!medicare_number, 5, 1))
   templ.Subst("MA6", Mid$(currentconsult!patient!medicare_number, 6, 1))
   templ.Subst("MA7", Mid$(currentconsult!patient!medicare_number, 7, 1))
   templ.Subst("MA8", Mid$(currentconsult!patient!medicare_number, 8, 1))
   templ.Subst("MA9", Mid$(currentconsult!patient!medicare_number, 9, 1)) 
   templ.Subst("MA0", Mid$(currentconsult!patient!medicare_number, 10, 1))
   templ.Subst("employerdetails", "the employer details")
   templ.Subst("occupation", "Airline Hostess")
   templ.Subst("CERTIFICATEDATE1", Mid$(certificatedate, 1, 1))
   templ.Subst("CERTIFICATEDATE2", Mid$(certificatedate, 2, 1))
   templ.Subst("CERTIFICATEDATE3", Mid$(certificatedate, 4, 1))
   templ.Subst("CERTIFICATEDATE4", Mid$(certificatedate, 5, 1))
   templ.Subst("CERTIFICATEDATE5", Mid$(certificatedate, 7, 1))
   templ.Subst("CERTIFICATEDATE6", Mid$(certificatedate, 8, 1))
   templ.Subst("CERTIFICATEDATE7", Mid$(certificatedate, 9, 1))
   templ.Subst("CERTIFICATEDATE8", Mid$(certificatedate, 10, 1))   
   templ.Subst("diagnosis", "Fractured Femur")   
   
   templ.Subst("STATEDINJURYDATE1", Mid$(statedinjurydate, 1, 1))
   templ.Subst("STATEDINJURYDATE2", Mid$(statedinjurydate, 2, 1))
   templ.Subst("STATEDINJURYDATE3", Mid$(statedinjurydate, 4, 1))
   templ.Subst("STATEDINJURYDATE4", Mid$(statedinjurydate, 5, 1))
   templ.Subst("STATEDINJURYDATE5", Mid$(statedinjurydate, 7, 1))
   templ.Subst("STATEDINJURYDATE6", Mid$(statedinjurydate, 8, 1))
   templ.Subst("STATEDINJURYDATE7", Mid$(statedinjurydate, 9, 1))
   templ.Subst("STATEDINJURYDATE8", Mid$(statedinjurydate, 10, 1)) 
   
   templ.Subst("FIRSTSEENDATE1", Mid$(firstseendate, 1, 1))
   templ.Subst("FIRSTSEENDATE2", Mid$(firstseendate, 2, 1))
   templ.Subst("FIRSTSEENDATE3", Mid$(firstseendate, 4, 1))
   templ.Subst("FIRSTSEENDATE4", Mid$(firstseendate, 5, 1))
   templ.Subst("FIRSTSEENDATE5", Mid$(firstseendate, 7, 1))
   templ.Subst("FIRSTSEENDATE6", Mid$(firstseendate, 8, 1))
   templ.Subst("FIRSTSEENDATE7", Mid$(firstseendate, 9, 1))
   templ.Subst("FIRSTSEENDATE8", Mid$(firstseendate, 10, 1))  
   templ.Subst("consistantwithinjuryyes", "x")
   templ.Subst("consistantwithinjuryno", "x")      
   templ.Subst("consistantwithinjuryuncertain", "x") 
   templ.Subst("historyofinjury", "Fell off a roof from a great height") 
   templ.Subst("pre-existant-factors", "The guy is a malingerer")
   templ.Subst_common(currentconsult)
   Print templ.GetData()
   'templ.Subst("postcode", "\\relax")
   templ.Subst("pdf_path", modUtil.Find_File("templates" &/ "nsw-workcover-certificate-of-capacity-page1.pdf"))
   
   Print templ.GetData()
   modPrinting.Print_latex_tempRT(templ.GetData())
   '  modPrinting.Print_latex(templ.GetData())
   
End
