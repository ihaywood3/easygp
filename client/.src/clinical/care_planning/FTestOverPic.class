' Gambas class file

Private CurrentConsult As CConsult

Public Sub Init(Cons As CConsult)
   
   Currentconsult = Cons
   
End

Public Sub Button1_Click()
   
   Dim templ As New CTemplate("epc-form1", "tex")
   
   templ.Subst_common(currentconsult)
   templ.Subst("postcode", "\\relax")
   templ.Subst("pdf_path", modUtil.Find_File("templates" &/ "epc_referral.pdf"))
   If chkGPMP.Value = True Then
      templ.Subst("Has_GPMP_and_TCA", "X")
   Else
      templ.Subst("Has_GPMP_and_TCA", "\\relax")
   Endif
   If chkMDCP.value = True Then
      templ.Subst("Multi_disciplinary_care_plan_aged_care", "X")
   Else
      templ.Subst("Multi_disciplinary_care_plan_aged_care", "\\relax")
   Endif
   Print templ.GetData()
   modPrinting.Print_latex(templ.GetData())
   
End

Public Sub Button2_Click()
   
   Dim templ_page1 As New CTemplate("nswwcpage1", "tex")
   Dim templ_page2 As New Ctemplate("nswwcpage2", "tex")
   Dim templ_page3 As New Ctemplate("nswwcpage3", "tex")
   Dim birthdate As String
   Dim certificatedate As String = Format(Now(), "dd/mm/yyyy")
   Dim statedinjurydate As String = "01/02/2010"
   Dim firstseendate As String = "02/03/2011"
   Dim SUITABLEDUTIESFROM As String = "01/03/2012"
   Dim SUITABLEDUTIESTO As String = "01/04/2012"
   Dim UNFITFROM As String = "02/03/2012"
   Dim UNFITTO As String = "02/04/2012"
   Dim DATEREVIEW As String = "03/06/2012"
   Dim DATESIGNED As String = "19/01/2013"
   Dim comm As Collection 
   Dim PROVIDERNO As String = modDBConnect.currentUser!provider_number
   Dim CLAIMNUMBER As String = "0123456789"
   
   If IsNull(currentconsult!patient!medicare_number) Then 
      currentconsult!patient!medicare_number = "0000000000" 'FIXME PUT THIS IN UNTIL REPAT STUFF SORTED
   End If   
   If IsNull(currentconsult!patient!birthdate) Then
      currentconsult!patient!birthdate = "00/00/0000"
   Endif
   birthdate = Format(currentconsult!patient!birthdate, "dd/mm/yyyy")
   templ_page1.Subst_common(currentconsult)
   templ_page2.Subst_common(currentconsult) 
   templ_page3.Subst_common(currentconsult) 
   templ_page1.Subst("pdf_path", modUtil.Find_File("templates" &/ "nsw-workcover-certificate-of-capacity-page1.eps"))
   templ_page2.Subst("pdf_path", modUtil.Find_File("templates" &/ "nsw-workcover-certificate-of-capacity-page2.eps"))
   templ_page3.Subst("pdf_path", modUtil.Find_File("templates" &/ "nsw-workcover-certificate-of-capacity-page3.eps"))
  
   templ_page1.Subst("DOB1", Mid$(birthdate, 1, 1))
   templ_page1.Subst("DOB2", Mid$(birthdate, 2, 1))
   templ_page1.Subst("DOB3", Mid$(birthdate, 4, 1))
   templ_page1.Subst("DOB4", Mid$(birthdate, 5, 1))
   templ_page1.Subst("DOB5", Mid$(birthdate, 7, 1))
   templ_page1.Subst("DOB6", Mid$(birthdate, 8, 1))
   templ_page1.Subst("DOB7", Mid$(birthdate, 9, 1))
   templ_page1.Subst("DOB8", Mid$(birthdate, 10, 1))
   

   
   templ_page1.Subst("CLAIMNUMBER01", Mid$(CLAIMNUMBER, 1, 1))
   templ_page1.Subst("CLAIMNUMBER2", Mid$(CLAIMNUMBER, 2, 1))
   templ_page1.Subst("CLAIMNUMBER3", Mid$(CLAIMNUMBER, 3, 1))
   templ_page1.Subst("CLAIMNUMBER4", Mid$(CLAIMNUMBER, 4, 1))
   templ_page1.Subst("CLAIMNUMBER5", Mid$(CLAIMNUMBER, 5, 1))
   templ_page1.Subst("CLAIMNUMBER6", Mid$(CLAIMNUMBER, 6, 1))
   templ_page1.Subst("CLAIMNUMBER7", Mid$(CLAIMNUMBER, 7, 1))
   templ_page1.Subst("CLAIMNUMBER8", Mid$(CLAIMNUMBER, 8, 1))   
   templ_page1.Subst("CLAIMNUMBER9", Mid$(CLAIMNUMBER, 9, 1))
   templ_page1.Subst("CLAIMNUMBER10", Mid$(CLAIMNUMBER, 10, 1)) 
     ' 
   templ_page1.Subst("MA1", Mid$(currentconsult!patient!medicare_number, 1, 1))
   templ_page1.Subst("MA2", Mid$(currentconsult!patient!medicare_number, 2, 1))
   templ_page1.Subst("MA3", Mid$(currentconsult!patient!medicare_number, 3, 1))
   templ_page1.Subst("MA4", Mid$(currentconsult!patient!medicare_number, 4, 1))
   templ_page1.Subst("MA5", Mid$(currentconsult!patient!medicare_number, 5, 1))
   templ_page1.Subst("MA6", Mid$(currentconsult!patient!medicare_number, 6, 1))
   templ_page1.Subst("MA7", Mid$(currentconsult!patient!medicare_number, 7, 1))
   templ_page1.Subst("MA8", Mid$(currentconsult!patient!medicare_number, 8, 1))
   templ_page1.Subst("MA9", Mid$(currentconsult!patient!medicare_number, 9, 1)) 
   templ_page1.Subst("MA0", Mid$(currentconsult!patient!medicare_number, 10, 1))
   templ_page1.Subst("employerdetails", "the employer details")
   templ_page1.Subst("occupation", "Airline Hostess")
   templ_page1.Subst("CERTIFICATEDATE1", Mid$(certificatedate, 1, 1))
   templ_page1.Subst("CERTIFICATEDATE2", Mid$(certificatedate, 2, 1))
   templ_page1.Subst("CERTIFICATEDATE3", Mid$(certificatedate, 4, 1))
   templ_page1.Subst("CERTIFICATEDATE4", Mid$(certificatedate, 5, 1))
   templ_page1.Subst("CERTIFICATEDATE5", Mid$(certificatedate, 7, 1))
   templ_page1.Subst("CERTIFICATEDATE6", Mid$(certificatedate, 8, 1))
   templ_page1.Subst("CERTIFICATEDATE7", Mid$(certificatedate, 9, 1))
   templ_page1.Subst("CERTIFICATEDATE8", Mid$(certificatedate, 10, 1))   
   templ_page1.Subst("diagnosis", "Fractured Femur")   
   
   templ_page1.Subst("STATEDINJURYDATE1", Mid$(statedinjurydate, 1, 1))
   templ_page1.Subst("STATEDINJURYDATE2", Mid$(statedinjurydate, 2, 1))
   templ_page1.Subst("STATEDINJURYDATE3", Mid$(statedinjurydate, 4, 1))
   templ_page1.Subst("STATEDINJURYDATE4", Mid$(statedinjurydate, 5, 1))
   templ_page1.Subst("STATEDINJURYDATE5", Mid$(statedinjurydate, 7, 1))
   templ_page1.Subst("STATEDINJURYDATE6", Mid$(statedinjurydate, 8, 1))
   templ_page1.Subst("STATEDINJURYDATE7", Mid$(statedinjurydate, 9, 1))
   templ_page1.Subst("STATEDINJURYDATE8", Mid$(statedinjurydate, 10, 1)) 
   
   templ_page1.Subst("FIRSTSEENDATE1", Mid$(firstseendate, 1, 1))
   templ_page1.Subst("FIRSTSEENDATE2", Mid$(firstseendate, 2, 1))
   templ_page1.Subst("FIRSTSEENDATE3", Mid$(firstseendate, 4, 1))
   templ_page1.Subst("FIRSTSEENDATE4", Mid$(firstseendate, 5, 1))
   templ_page1.Subst("FIRSTSEENDATE5", Mid$(firstseendate, 7, 1))
   templ_page1.Subst("FIRSTSEENDATE6", Mid$(firstseendate, 8, 1))
   templ_page1.Subst("FIRSTSEENDATE7", Mid$(firstseendate, 9, 1))
   templ_page1.Subst("FIRSTSEENDATE8", Mid$(firstseendate, 10, 1))  
   templ_page1.Subst("consistantwithinjuryyes", "x")
   templ_page1.Subst("consistantwithinjuryno", "x")      
   templ_page1.Subst("consistantwithinjuryuncertain", "x") 
   templ_page1.Subst("historyofinjury", "Fell off a roof from a great height") 
   templ_page1.Subst("pre-existant-factors", "The guy is a malingerer")
   '---------------
   'start of page 2
   '---------------
   templ_page2.Subst("claim-number", "claim-number")
   templ_page2.Subst("management-plan", "the management plan")
   templ_page2.Subst("referrals-to-providers", "referrals-to-providers")
   templ_page2.Subst("obtain-copy-work-duties-yes", "x")
   templ_page2.Subst("obtain-copy-work-duties-no", "x")
   templ_page2.Subst("fit-pre-injury-duties", "x")
   templ_page2.Subst("fit-suitable-duties", "x")
   
   templ_page2.Subst("SUITABLEDUTIESFROM1", Mid$(SUITABLEDUTIESFROM, 1, 1))
   templ_page2.Subst("SUITABLEDUTIESFROM2", Mid$(SUITABLEDUTIESFROM, 2, 1))
   templ_page2.Subst("SUITABLEDUTIESFROM3", Mid$(SUITABLEDUTIESFROM, 4, 1))
   templ_page2.Subst("SUITABLEDUTIESFROM4", Mid$(SUITABLEDUTIESFROM, 5, 1))
   templ_page2.Subst("SUITABLEDUTIESFROM5", Mid$(SUITABLEDUTIESFROM, 7, 1))
   templ_page2.Subst("SUITABLEDUTIESFROM6", Mid$(SUITABLEDUTIESFROM, 8, 1))
   templ_page2.Subst("SUITABLEDUTIESFROM7", Mid$(SUITABLEDUTIESFROM, 9, 1))
   templ_page2.Subst("SUITABLEDUTIESFROM8", Mid$(SUITABLEDUTIESFROM, 10, 1))  
   
   templ_page2.Subst("SUITABLEDUTIESTO1", Mid$(SUITABLEDUTIESTO, 1, 1))
   templ_page2.Subst("SUITABLEDUTIESTO2", Mid$(SUITABLEDUTIESTO, 2, 1))
   templ_page2.Subst("SUITABLEDUTIESTO3", Mid$(SUITABLEDUTIESTO, 4, 1))
   templ_page2.Subst("SUITABLEDUTIESTO4", Mid$(SUITABLEDUTIESTO, 5, 1))
   templ_page2.Subst("SUITABLEDUTIESTO5", Mid$(SUITABLEDUTIESTO, 7, 1))
   templ_page2.Subst("SUITABLEDUTIESTO6", Mid$(SUITABLEDUTIESTO, 8, 1))
   templ_page2.Subst("SUITABLEDUTIESTO7", Mid$(SUITABLEDUTIESTO, 9, 1))
   templ_page2.Subst("SUITABLEDUTIESTO8", Mid$(SUITABLEDUTIESTO, 10, 1))  
   
   templ_page2.Subst("suitable-duties-hours-per-day", "8")
   templ_page2.Subst("suitable-duties-days-per-week", "5")
   templ_page2.Subst("unfit-for-work", "x")
   
   templ_page2.Subst("UNFITFROM1", Mid$(UNFITFROM, 1, 1))
   templ_page2.Subst("UNFITFROM2", Mid$(UNFITFROM, 2, 1))
   templ_page2.Subst("UNFITFROM3", Mid$(UNFITFROM, 4, 1))
   templ_page2.Subst("UNFITFROM4", Mid$(UNFITFROM, 5, 1))
   templ_page2.Subst("UNFITFROM5", Mid$(UNFITFROM, 7, 1))
   templ_page2.Subst("UNFITFROM6", Mid$(UNFITFROM, 8, 1))
   templ_page2.Subst("UNFITFROM7", Mid$(UNFITFROM, 9, 1))
   templ_page2.Subst("UNFITFROM8", Mid$(UNFITFROM, 10, 1))  
   
   templ_page2.Subst("UNFITTO1", Mid$(UNFITTO, 1, 1))
   templ_page2.Subst("UNFITTO2", Mid$(UNFITTO, 2, 1))
   templ_page2.Subst("UNFITTO3", Mid$(UNFITTO, 4, 1))
   templ_page2.Subst("UNFITTO4", Mid$(UNFITTO, 5, 1))
   templ_page2.Subst("UNFITTO5", Mid$(UNFITTO, 7, 1))
   templ_page2.Subst("UNFITTO6", Mid$(UNFITTO, 8, 1))
   templ_page2.Subst("UNFITTO7", Mid$(UNFITTO, 9, 1))
   templ_page2.Subst("UNFITTO8", Mid$(UNFITTO, 10, 1))  
   templ_page2.Subst("estimated-time-before-can-work", "est time to work never")
   templ_page2.Subst("factors-delaying-recovery", "is fucked in the head")
   templ_page2.Subst("refer-to-rehabilitation-provider-yes", "x")
   templ_page2.Subst("refer-to-rehabilitation-provider-no", "x")
   templ_page2.Subst("capacity-lifting-carrying", "will not carry")
   templ_page2.Subst("capacity-sitting", "capacity-sitting")
   templ_page2.Subst("capacity-standing", "capacity-standing")
   templ_page2.Subst("capacity-pushing-pulling", "capacity-pushing-pulling")
   templ_page2.Subst("capacity-bending-twisting-squatting", "capacity-bending-twisting-squatting")
   templ_page2.Subst("capacity-driving", "capacity-driving")
   templ_page2.Subst("capacity-other", "capacity-other")
   templ_page2.Subst("DATEREVIEW1", Mid$(DATEREVIEW, 1, 1))
   templ_page2.Subst("DATEREVIEW2", Mid$(DATEREVIEW, 2, 1))
   templ_page2.Subst("DATEREVIEW3", Mid$(DATEREVIEW, 4, 1))
   templ_page2.Subst("DATEREVIEW4", Mid$(DATEREVIEW, 5, 1))
   templ_page2.Subst("DATEREVIEW5", Mid$(DATEREVIEW, 7, 1))
   templ_page2.Subst("DATEREVIEW6", Mid$(DATEREVIEW, 8, 1))
   templ_page2.Subst("DATEREVIEW7", Mid$(DATEREVIEW, 9, 1))
   templ_page2.Subst("DATEREVIEW8", Mid$(DATEREVIEW, 10, 1))
   templ_page2.Subst("comments", "comments")
   templ_page2.Subst("treating-doctor-agrees", "x")
   templ_page2.Subst("nominated-treating-doctor", "x")
   templ_page2.Subst("treating-specialist", "x")
   templ_page2.Subst("treating-other", "x")
   '   
   templ_page2.Subst("DATESIGNED1", Mid$(DATESIGNED, 1, 1))
   templ_page2.Subst("DATESIGNED2", Mid$(DATESIGNED, 2, 1))
   templ_page2.Subst("DATESIGNED3", Mid$(DATESIGNED, 4, 1))
   templ_page2.Subst("DATESIGNED4", Mid$(DATESIGNED, 5, 1))
   templ_page2.Subst("DATESIGNED5", Mid$(DATESIGNED, 7, 1))
   templ_page2.Subst("DATESIGNED6", Mid$(DATESIGNED, 8, 1))
   templ_page2.Subst("DATESIGNED7", Mid$(DATESIGNED, 9, 1))
   templ_page2.Subst("DATESIGNED8", Mid$(DATESIGNED, 10, 1))  
   templ_page2.Subst("other-specified", "other-specified")
   For Each comm In modDBConnect.currentUser!comms
      If comm!fk_type = const.CommModalityPhone Then
         comm!value = Replace(comm!value, " ", "")
         templ_page2.Subst("OFFICEPHONE01", Mid$(comm!value, 1, 1))
         templ_page2.Subst("OFFICEPHONE2", Mid$(comm!value, 2, 1))
         templ_page2.Subst("OFFICEPHONE3", Mid$(comm!value, 3, 1))
         templ_page2.Subst("OFFICEPHONE4", Mid$(comm!value, 4, 1))
         templ_page2.Subst("OFFICEPHONE5", Mid$(comm!value, 5, 1))
         templ_page2.Subst("OFFICEPHONE6", Mid$(comm!value, 6, 1))
         templ_page2.Subst("OFFICEPHONE7", Mid$(comm!value, 7, 1))
         templ_page2.Subst("OFFICEPHONE8", Mid$(comm!value, 8, 1))  
         templ_page2.Subst("OFFICEPHONE9", Mid$(comm!value, 9, 1))
         templ_page2.Subst("OFFICEPHONE10", Mid$(comm!value, 10, 1))  
      End If
   Next
   templ_page2.Subst("OFFICEPHONE01", "\\relax")
   templ_page2.Subst("OFFICEPHONE2", "\\relax")
   templ_page2.Subst("OFFICEPHONE3", "\\relax")
   templ_page2.Subst("OFFICEPHONE4", "\\relax")
   templ_page2.Subst("OFFICEPHONE5", "\\relax")
   templ_page2.Subst("OFFICEPHONE6", "\\relax")
   templ_page2.Subst("OFFICEPHONE7", "\\relax")
   templ_page2.Subst("OFFICEPHONE8", "\\relax")  
   templ_page2.Subst("OFFICEPHONE9", "\\relax")  
   templ_page2.Subst("OFFICEPHONE10", "\\relax")  
   
   Templ_page2.Subst("PROVIDERNO1", Mid$(PROVIDERNO, 1, 1))
   templ_page2.Subst("PROVIDERNO2", Mid$(PROVIDERNO, 2, 1))
   templ_page2.Subst("PROVIDERNO3", Mid$(PROVIDERNO, 3, 1))
   templ_page2.Subst("PROVIDERNO4", Mid$(PROVIDERNO, 4, 1))
   templ_page2.Subst("PROVIDERNO5", Mid$(PROVIDERNO, 5, 1))
   templ_page2.Subst("PROVIDERNO6", Mid$(PROVIDERNO, 6, 1))
   templ_page2.Subst("PROVIDERNO7", Mid$(PROVIDERNO, 7, 1))
   templ_page2.Subst("PROVIDERNO8", Mid$(PROVIDERNO, 8, 1))  
   
   Templ_page2.Subst("PROVIDERNO1", "\\relax")  
   templ_page2.Subst("PROVIDERNO2", "\\relax")  
   templ_page2.Subst("PROVIDERNO3", "\\relax")  
   templ_page2.Subst("PROVIDERNO4", "\\relax")  
   templ_page2.Subst("PROVIDERNO5", "\\relax")  
   templ_page2.Subst("PROVIDERNO6", "\\relax")  
   templ_page2.Subst("PROVIDERNO7", "\\relax")  
   templ_page2.Subst("PROVIDERNO8", "\\relax")  
   modPrinting.Print_latex_tempRT(templ_page1.GetData())
  '   modPrinting.Print_latex(templ_page1.GetData())
   ' modPrinting.Print_latex_tempRT(templ_page2.GetData())
   '-------
   ' page 3
   '-------
   templ_page3.Subst("DOB1", Mid$(birthdate, 1, 1))
   templ_page3.Subst("DOB2", Mid$(birthdate, 2, 1))
   templ_page3.Subst("DOB3", Mid$(birthdate, 4, 1))
   templ_page3.Subst("DOB4", Mid$(birthdate, 5, 1))
   templ_page3.Subst("DOB5", Mid$(birthdate, 7, 1))
   templ_page3.Subst("DOB6", Mid$(birthdate, 8, 1))
   templ_page3.Subst("DOB7", Mid$(birthdate, 9, 1))
   templ_page3.Subst("DOB8", Mid$(birthdate, 10, 1))
   templ_page3.Subst("CLAIMNUMBER01", Mid$(CLAIMNUMBER, 1, 1))
   templ_page3.Subst("CLAIMNUMBER2", Mid$(CLAIMNUMBER, 2, 1))
   templ_page3.Subst("CLAIMNUMBER3", Mid$(CLAIMNUMBER, 3, 1))
   templ_page3.Subst("CLAIMNUMBER4", Mid$(CLAIMNUMBER, 4, 1))
   templ_page3.Subst("CLAIMNUMBER5", Mid$(CLAIMNUMBER, 5, 1))
   templ_page3.Subst("CLAIMNUMBER6", Mid$(CLAIMNUMBER, 6, 1))
   templ_page3.Subst("CLAIMNUMBER7", Mid$(CLAIMNUMBER, 7, 1))
   templ_page3.Subst("CLAIMNUMBER8", Mid$(CLAIMNUMBER, 8, 1))   
   templ_page3.Subst("CLAIMNUMBER9", Mid$(CLAIMNUMBER, 9, 1))
   templ_page3.Subst("CLAIMNUMBER10", Mid$(CLAIMNUMBER, 10, 1))   
   templ_page3.Subst("CLAIMNUMBER01", "\\relax")
   templ_page3.Subst("CLAIMNUMBER2", "\\relax")
   templ_page3.Subst("CLAIMNUMBER3", "\\relax")
   templ_page3.Subst("CLAIMNUMBER4", "\\relax")
   templ_page3.Subst("CLAIMNUMBER5", "\\relax")
   templ_page3.Subst("CLAIMNUMBER6", "\\relax")
   templ_page3.Subst("CLAIMNUMBER7", "\\relax")
   templ_page3.Subst("CLAIMNUMBER8", "\\relax")
   templ_page3.Subst("CLAIMNUMBER9", "\\relax")
   templ_page3.Subst("CLAIMNUMBER10", "\\relax")
   
   templ_page3.Subst("DATESIGNED1", Mid$(DATESIGNED, 1, 1))
   templ_page3.Subst("DATESIGNED2", Mid$(DATESIGNED, 2, 1))
   templ_page3.Subst("DATESIGNED3", Mid$(DATESIGNED, 4, 1))
   templ_page3.Subst("DATESIGNED4", Mid$(DATESIGNED, 5, 1))
   templ_page3.Subst("DATESIGNED5", Mid$(DATESIGNED, 7, 1))
   templ_page3.Subst("DATESIGNED6", Mid$(DATESIGNED, 8, 1))
   templ_page3.Subst("DATESIGNED7", Mid$(DATESIGNED, 9, 1))
   templ_page3.Subst("DATESIGNED8", Mid$(DATESIGNED, 10, 1)) 
 '  modPrinting.Print_latex_tempRT(templ_page3.GetData())
   
End
