' Gambas class file
' Copyright (C) 2008,2009 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
Private bExit As Boolean
Private cons As cConsult

Public Sub Form_Open()
  
  
  Init()
  
End

Public Sub Init()
  
  EditArea_Clear()
  Certificate_New()
  
End
Public Sub EditArea_Clear()
  
  modEditAreaHelpers.EditArea_Clear(VBox2)
  
End
Public Sub Certificate_New()
  txtdate.text = Format(Now, "dd/mm/yyyy")
  rbIsUnfit.value = True
  txtCondition.SetFocus()
  
End

Public Sub Form_Save()
  
   FClinical.Refresh_AllPreviousNotes()
  
End
Public Sub EditAreaButtons_Click()
  Dim hCtrl As Control
  Dim txtbox As TextBox
  Select Case Last.tag
 
  Case "pick date"
  For Each Hctrl In Last.parent.children
   If hctrl Is textbox Then
      txtbox = hctrl
      DateChooser1.tag = txtbox
      Break
   End If
  Next 
       With HBox_Calander
            .top = Last.Parent.Parent.top + Last.Parent.Height
            .left = Last.Parent.left
            .Raise()
        End With     
   
    DateChooser1.Parent.Visible = True 
    DateChooser1.Parent.Raise 
 
  End Select

End

Public Sub DateChooser1_Activate()
     Last.tag.text = Format(Last.value, "dd/mm/yyyy")
     HBox_Calander.Visible = False  
     Select Case Last.tag.tag
     Case "unfit from"
     txtDateTo.setfocus()
     Case "unfit to"
     End Select
End

Public Sub DateChooser1_LostFocus()
   DateChooser1.visible = False  
End
Public Sub EditAreaTextBox_LostFocus()
   '-------------------------------------------------------------
   'When textbox loses focus, change color of background to white
   '
   '-------------------------------------------------------------
   Last.BackGround = Color.White
End
Public Sub ToolButton3_Click()

  Me.Close()

End

Public Sub EditAreaTextBox_GotFocus()

   Last.BackGround = Color.rgb(95, 255, 175)
   Select Case Last.tag
   Case "condition"
   Case "unfit from", "unfit to"
        DateChooser1.tag = Last
   End Select
End

Public Sub EditAreaTextBox_KeyPress()
   If bexit Then Return
   
  Select Case Key.Code
  Case Key.Return, Key.Tab
   Select Case Last.tag
      Case "date"
         txtCondition.SetFocus()
      Case "condition"
         txtDateFrom.SetFocus()
   End Select
  End Select

End
Public Sub mnuHealthIssues_Show()
  
' mnuHealthIssues_Refresh()
  
End
