' Gambas class file

' Copyright (C) 2008-2015 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.

Private possible_problems As Collection 

Public Sub Form_Load()
  
   Init()
  
End


Public Sub Init()
   possible_problems = New Collection 
End



 Public Function Mobility_Problems_Get() As Collection 
  '-----------------------------------------------------
  ' Returns a collection of text (tag of the Hbox
  ' containing the question) which are possible problems
  '-----------------------------------------------------
  Dim hCtrl As Control
  Dim HBoxContainer As HBox
  Dim HBoxRadioButtonContainer As HBox
  Dim rb As RadioButton
  Dim possible_problem As String
  
  possible_problems = New Collection 
  For Each hctrl In VBox_Mobility.children
   If hctrl Is Hbox Then
       HBoxContainer = hCtrl
       possible_problem = HBoxContainer.tag
       For Each hctrl In HBoxContainer.Children
         If hctrl Is Hbox Then
            HBoxRadioButtonContainer = hCtrl
             For Each hctrl In HBoxRadioButtonContainer.children
                  If hctrl Is RadioButton Then
                     rb = hctrl
                     If rb.value = True And rb.tag <> "hidden" Then
                        If Val(rb.tag) <> 0 Then
                              possible_problems.Add(possible_problem, possible_problems.count)
                         End If
                         Break
                     End If
                  End If
             Next
         End If   
      Next
   End If
  Next
  Return possible_problems
End 
Public Sub EditArea_TextBox_GotFocus()

    Last.BackGround = Color.rgb(95, 255, 175)

End

Public Sub EditArea_TextBox_LostFocus()

   Last.BackGround = Color.White

End


Public Sub rbMobility_Enter()

   modEditAreaHelpers.Hightlight_Label(Last.parent.parent, True)
   

End

Public Sub rbMobility_Leave()

   modEditAreaHelpers.Hightlight_Label(Last.parent.parent, False)
   

End
