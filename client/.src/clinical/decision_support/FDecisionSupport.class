' Gambas class file

' Copyright (C) 2008-2014 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.

Private help_section As String

Public Sub Init(F As Form, Form_type As Form) 'fixme historical ?not used
   
   Settings_Load  

End

Public Sub Set_Help_Section(hs As String)
   
  help_section = hs 
   
End

Public Sub tbWebBrowser_Click()
   
   Select Case Last.tag
      Case "print"
         Print_Content
      Case "zoom in"
         zoom_in()
      Case "zoom out"
         zoom_out()
   End Select
   
End

Public Sub Print_Content()
   
   
   
End

Public Sub zoom_in()
   'Don't put this back in tbWebBrowser_click as is called from outside this form
   
   WebView1.Zoom = Round(webview1.Zoom * 1.1, -2)
   Settings_Save
   
End

Public Sub zoom_out()
   'Don't put this back in tbWebBrowser_click as is called from outside this form
   
   WebView1.Zoom = Round(webview1.Zoom / 1.1, -2)
   Settings_Save
   
End

Public Sub Form_Close()
   
   Settings_Save 
   If chkDontShowAgain.value = True And help_section <> "" Then
      modAdminDBI.Record_Tip_Seen(help_section)
   Endif
   Me.Close(True)

End

Private Sub Settings_Load()
   
   webview1.Zoom = Settings["FDecision/Webview1.zoom", 1]
   
End

Public Sub Settings_Save()
   
   Settings["FDecision/Webview1.zoom"] = webview1.Zoom
   
End

Public Sub tbClose_Click()
   
End

Public Sub chkDontShowAgain_Click()
   
   If Last.value = True Then
      Message.Title = help_section & " Decision Support"
      Message.Info("This won't be shown again after you close this form, but you can see it any time by clicking on the 'Support' button on the main clinical toolbar, when using this section of the program")
    '  Me.Close
   Endif
   
End


