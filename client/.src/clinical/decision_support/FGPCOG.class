' Gambas class file
' Copyright (C) 2008-2011 Dr Richard TERRY

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
'----------------------------------------------------------------------
' PURPOSE      A form to present the GPCOG dementia screen
' LICENCE      http://www.gpcog.com.au/faq.php#C1
'
' 2. What are the costs for using the GPCOG?
' 
' The GPCOG is free for clinicians and researchers.
' Use of the website or downloading the paper-and-pencil test doesn't cost anything. 
' However, we do ask you not to change any content of the GPCOG and also to have the original reference printed on the worksheets
' (Brodaty et al, JAGS 2002; 50:530-534). Commercial companies seeking permission to use the GPCOG should write to gpcog@unsw.edu.au.  
' 
' 3. Can I reprint the GPCOG?
' 
' If you are using the GPCOG for clinical purposes, you can download and print out as many copies of the paper GPCOG in as many languages as you wish.
' You can also access the website and administer the web-based GPCOG as many times as you wish.
' However, if you intend to re-print the GPCOG for your own research articles, published work or website,
' we ask you to seek permission from the Journal of the American Geriatrics Society.
' We also ask you to acknowledge the authors of the original GPCOG publication in any publication arising from your research work with the GPCOG. 
' 

' GPCOG Patient Examination
' Unless specified, each question should only be asked once.
' Name and address for subsequent recall
' "I am going to give you a name and address. After I have said it, I want you to repeat it. Remember this name and address because I am going to ask you to tell it to me again in a few minutes: John Brown, 42 West Street, Kensington"
' 
' (Allow a maximum of 4 attempts but do not score yet)
' Time Orientation
' What is the date? (accept exact only)	
' Clock Drawing (visuospatial functioning) use a paper with a printed circle.
' Please mark in all the numbers to indicate the hours of a clock (correct spacing required).	
' For a correct response (above), the numbers 12, 3, 6, and 9 should be in the correct quadrants of the circle
' and the other numbers should be approximately correctly placed.
' Please mark in hands to show 10 minutes past eleven o'clock (11:10).	
' For a correct response (above), the hands should be pointing to the 11 and the 2,
' but do not penalise if the respondent fails to distinguish the long and short hands.
' Information
' Can you tell me something that happened in the news recently? (recently = in the last week)	
' Respondents are not required to provide extensive details, as long as they demonstrate awareness of a recent news story. 
' If a general answer is given, such as "war", "a lot of rain", ask for details.
' If unable to give details, the answer should be scored as incorrect.
' Recall
' What was the name and address I asked you to remember?
' Score for each of the 5 components - John, Brown, 42, West Street, Kensington.	
'   GPCOG Patient Score =  /9	
' GPCOG Informant Interview
' Ask the informant: "Compared to a few years ago"
' Does the patient have more trouble remembering things that have happened recently?	
' Does he or she have more trouble recalling conversations a few days later?	
' When speaking, does the patient have more difficulty in finding the right word or tend to use the wrong words more often?	
' Is the patient less able to manage money and financial affairs (e.g., paying bills, budgeting)?	
' Is the patient less able to manage his or her medication independently?	
' Does the patient need more assistance with transport (either private or public)?	
' Score 1 point for each "no" answer.
'   Informant Score =  /6	
' Combined (overall) score =  /15
'
'----------------------------------------------------------------------
Private currentconsult As CConsult

Public Sub Init(cons As CConsult)
   currentconsult = cons
   Build_Form() 
   
End

Public Sub Build_Form()
    '   "This is a new screening test developed in Australia for use in general practice. It is shorter than the "
    ' "MMSE and incorporates the clock drawing test. Only if the test result is in the doubtful "
    ' "area does it need to include some additional information to be obtained from a suitable informant.</P>"
    ' ""
    ' "<B>Scoring</B>"
    ' "Add correct scores from items 2-6:"
    ' "<UL><LI>9 = cognitively intact – no need for informant interview"
    ' "<LI>4 or less = cognitively impaired – no need for informant interview"
    ' "<LI>5-8 = uncertain – needs informant interview"
    ' "</UL>"
    ' "<P><B>Informant interview score:</B> No, 3 or less = cognitively impaired</P>"
    ' "<B>Reference</B><I> Brodaty H, Pond D et al. The GPCOG: a new screening test for dementia designed for general practice."
    ' "J Am Geriatric Soc 2002; 50: 530-34</I>"
    ' 
  
  TextLabel1.text = ""
   "<P ALIGN=CENTER><B>GPCOG Patient Examination</B> - "
 "Unless specified, Each question should only be asked once.</P>"
    textLabel2.text = ""
    "<P ALIGN=LEFT><i> I am going To give you a name And address. " 
    "After I have said it, I want you to repeat it. Remember this name "
    "and address because I am going to ask you to tell it to me again in "
    "a few minutes: </I>John Brown 42 West Street Kensington </P>"
   textLabel3.text =
       "<P ALIGN=LEFT>What is the Date</P>"
 textLabel4.text =
"<P ALIGN=LEFT><STRONG><I><SPAN STYLE=\"font-weight: normal\">Please"
      "mark in all the numbers to indicate the hours of a clock</SPAN></I></STRONG></P>"
 textLabel5.text =
    "<P ALIGN=LEFT><STRONG><I><SPAN STYLE=\"font-weight: normal\">"
      "Please mark in hands io show 10 minutes past eleven o'clock (11:10)</SPAN></I></STRONG></P>"
  tlNews.text = "" 
    "<P ALIGN=LEFT><STRONG><I><SPAN STYLE=\"font-weight: normal\">"
      " Can you tell me something that happened In the news recently?(recently = In the last week)</SPAN></I></STRONG></P>"
     
   tlNews.text = "" 
    "<P ALIGN=LEFT><STRONG><I><SPAN STYLE=\"font-weight: normal\">"
      "What was the name and address I asked you to remember?</P>"
     

      lblInstructions_Q1.text = "<P><B>Name and address for subsequent recall</B><BR>Allow a maximum of 4 attempts but do not score yet</P>"
      lblInstructions_Q2.text = "<P><B>Time Orientation</B><BR>Exact date only allowed</P>"
      lblInstructions_Q3.text = "<P><B>Clock Drawing Visuospacial Functioning</B><BR>Use a paper with a printed circle<BR>"
      "For a correct response, the numbers 12, 3, 6, and 9 should be in the correct quadrants of the circle"
      "and the other numbers should be approximately correctly placed.</P>"
      lblInstructions_Q4.text = "<P>For a correct response, the hands should be pointing to the 11 and the 2,"
                                 "but do not penalise If the respondent fails to distinguish the long and short hands.</P>"
      
      lblInstructions_Q6.text = "<B>Recall</B>"
      tlNews.text = "Can you tell me something that happened in the news recently? "
      textlabel12.text = "What was the name and address I asked you to remember?"
     lblInstructions_News.text = ""
     "<P>Respondents are not required to provide extensive details, as long as they demonstrate awareness of a recent news story. "
        "If a general answer is given, such as \"war\", \"a lot of rain\", ask for details."
        "If unable to give details, the answer should be scored as incorrect.</P>" 
      lblInstructions_Q5.text = "Score for each of the 5 components "
End

