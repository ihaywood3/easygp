' Gambas class file

' Copyright (C) 2008-2013 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
'---------------------------------------------------------------------
' PURPOSE   Contruct a row for a list container - with AnImages images
'---------------------------------------------------------------------

Private AnImage As Collection

Private AnImage_Photo As Picture
Private $hbox As HBox
Private $HBox_Picture As HBox
Private $PictureBox As PictureBox
Private $PnlSpacer As Panel
Private $TextLabel As TextLabel

Event dblclick()

Public Sub _new(hContainer As ListContainer, AnImage As Collection)
   'AnImage members = !pk,!image,!tag,!path   
   Dim hPict As Picture
   
   AnImage = AnImage         
   '--------------------------------------------------------------------------
   'This is the main 'container', holding the AnImage picture and text details
   '--------------------------------------------------------------------------     
   With $hbox = New HBox(hContainer)
      .Mouse = Mouse.Pointing
      .expand = False
      .padding = 3
      .AutoResize = True  
      .height = 80
      .tag = AnImage!pk
   End With
   '-------------------------------------------------------------------
   'Does the AnImage have a picture?, if not load an anonymous one
   'AnImage!image - this is blob data, not an image, must be converted
   '-------------------------------------------------------------------
   If Not IsNull(AnImage!image.data) Then 
      AnImage_Photo = modGraphics.Blob_Convert_To_Picture(AnImage!image)!picture  
   End If
   With $HBox_PIcture = New HBox($hbox)
      .width = 42
      .name = "HBox_AnImage_Photo"
      .Height = 42
      .Background = Color.White
      .padding = 1
   End With
   '--------------------------------------------------------------------------------------
   'This is a picture box, first child of the HBox in the continer, holds AnImages picture
   '--------------------------------------------------------------------------------------
   With $PictureBox = New PictureBox($HBox_Picture)
      .Border = True  
      .Background = Color.white 
      .Picture = AnImage_Photo
      .Stretch = True   
      .width = 40
      .Height = 40
      .Expand = False
   End With
   '-----------------------------------------------------
   'put a spacer between the picture and the next control
   '-----------------------------------------------------
   With $PnlSpacer = New Panel($hbox)
      .width = 50 
   End With
   '------------------------------------------------------
   'Now the images tag eg 'Basal Cell Carcinoma - Left Arm
   '------------------------------------------------------
   With $TextLabel = New TextLabel($Hbox)
      .Expand = True 
      .AutoResize = False
      .font = Font["Arial,10"]
      .text = "<P><FONT COLOR=\"#280099\"><SPAN STYLE='background:#ffffff'><B>" & Format(AnImage!consult_date, "dd/mm/yyyy") & "</B>"
      .text = "<P><B>" & Format(AnImage!consult_date, "dd/mm/yyyy") & "</B>"
      .text &= "&nbsp;&nbsp;" & AnImage!tag
   End With
End

Public Sub $TextLabel_Dblclick()
   Raise dblclick()
  
End 
