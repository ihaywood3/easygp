' Gambas class file

' Gambas class file

' Gambas class file
' Copyright (C) 2008-2016 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.

Private DASS21_stress As Integer 
Private DASS21_anxiety As Integer
Private DASS21_depression As Integer
Private depression_severity As String

Public Sub Form_Open()
  
  
  
  
End

Public Sub DASS21_Calculate()
  '---------------------------------------------------
  '   validates at least 1 option button set
  '   checks all option buttons and calculates the total
  ' the tag of each option button is set to 1-5
  '-------------------------------------------------------
  Dim hCtrl As Control
  Dim HBoxContainer As HBox
  Dim HBoxRadioButtonContainer As HBox
  Dim rb As RadioButton
 
  DASS21_anxiety = 0
  DASS21_depression = 0
  DASS21_stress = 0
  For Each hctrl In VBox_DASS.children
   If hctrl Is Hbox Then
      HBoxContainer = hCtrl
      For Each hctrl In HBoxContainer.Children
         If hctrl Is Hbox Then
            HBoxRadioButtonContainer = hCtrl
             For Each hctrl In HBoxRadioButtonContainer.children
             
                  If hctrl Is RadioButton Then
                     rb = hctrl
                     If rb.value = True And rb.tag <> "hidden" Then
                   
                      Select Case hCtrl.Parent.Tag
                      
                      Case 1, 6, 8, 11, 12, 14, 18 
                         DASS21_stress += Val(rb.tag)
                      Case 2, 4, 7, 9, 15, 19, 20
                         DASS21_anxiety += Val(rb.tag)
                       Case 3, 5, 10, 13, 16, 17, 21
                         DASS21_depression += Val(rb.tag)
                      End Select
                      Break
                     End If
                  End If
             Next
         End If   
      Next
   End If
  Next
  DASS21_stress = DASS21_stress * 2
  DASS21_anxiety = DASS21_anxiety * 2
  DASS21_depression = DASS21_depression * 2
  If DASS21_depression < 6 Then
     depression_severity = "normal"
  Else If DASS21_depression > 9 And DASS21_depression < 14 Then
       depression_severity = "mild"
  Else If DASS21_depression > 13 And DASS21_depression < 20 Then
    depression_severity = "moderate"
  Else If DASS21_depression > 20 And DASS21_depression < 27 Then
    depression_severity = "moderate"
  End If
   depression_severity = "severe"
  lblDASSResult.text = "Stress:" & Str$(DASS21_stress) & " Anxiety:" & Str$(DASS21_anxiety) & " Depression:" & Str$(DASS21_depression) & "(" & depression_severity & ")" 
    txtDassResult.text = lblDASSResult.text
  
End

Public Sub rbTired_Click()
   '---------------------------------------------------------
   'God knows how this radiobutton got named, but damned if
   'I'm going to rename them all to something sensible. I was
   'probably half asleep!
   '---------------------------------------------------------
   DASS21_Calculate()
End
Public Sub rbTired_Leave()
      Hightlight_Label(Last.Parent.parent, False)
End
Public Sub rbTired_Enter()
     Hightlight_Label(Last.Parent.Parent, True)
End

Public Sub lblQuestions_Leave()
  ' Last.foreground = Color.black
  ' Last.background = Color.White
  ' Last.Font.size = Last.Font.size - 2
End

Public Sub lblQuestions_Enter()
  ' Last.foreground = Color.white
  ' Last.background = Color.RGB(234, 234, 234)
  ' Last.background = Color.Black
  ' Last.Font.size = Last.Font.size + 2

End

Public Sub Save()
  
  
  
End

Public Sub EditAreaButtons_Click()

  Select Case Last.tag
  Case "save"
      Save()
  Case "new"
      DASS21_New()
  End Select

End
Public Sub DASS21_New()
    '---------------------------------------------------
  '   validates at least 1 option button set
  '   checks all option buttons and calculates the total
  ' the tag of each option button is set to 1-5
  '-------------------------------------------------------
  Dim hCtrl As Control
  Dim HBoxContainer As HBox
  Dim HBoxRadioButtonContainer As HBox
  Dim rb As RadioButton

  For Each hctrl In VBox_DASS.children
   If hctrl Is Hbox Then
       HBoxContainer = hCtrl
       For Each hctrl In HBoxContainer.Children
         If hctrl Is Hbox Then
            HBoxRadioButtonContainer = hCtrl
            For Each hctrl In HBoxRadioButtonContainer.children
             
                  If hctrl Is RadioButton And hctrl.tag = "hidden" Then 
                     rb = hctrl
                     rb.value = True 
                      Break
                  
                  End If
             Next
         End If   
       Next
   End If
  Next
  
End
Public Sub Hightlight_Label(TheBox As HBox, flag As Boolean)
      '-----------------------------------------------------------
      'As user moves over the option buttons, the question is made00
      'large and highlighted
      '----------------------------------------------------------- 
      Dim lbl As Label
      Dim hCtrl As Control
      For Each hctrl In TheBox.Children
         If hctrl Is Label Then 
            lbl = hctrl
            If lbl.tag = "question"
              If flag Then 
               lbl.foreground = Color.white
               lbl.background = Color.Black
               lbl.Font.size = Last.Font.size + 2
               
            Else
               lbl.foreground = Color.Black
               lbl.background = Color.White
               lbl.Font.size = Max(Last.Font.size - 2, Application.Font.Size)
             
              End If
            End If
            Break
         End If   
      Next
End

