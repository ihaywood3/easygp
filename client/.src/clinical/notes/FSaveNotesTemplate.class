' Gambas class file

Private template As Collection

Public Sub Run() As Boolean

  Return Not Me.ShowModal()

End

Public Sub Init(shtml As String)
   '----------------------------------------
   'Expects the html of the richtext control
   '----------------------------------------
   Template = New Collection
   Template!fk_staff = modDBConnect.currentUser!fk_staff
   Template!template = shtml
   Template!shared = False 
   
   
   
End

Public Sub btnOK_Click()

   If txtTemplateName.text = "" Then
      txtTemplateName.SetFocus() 
   Else
      Template!name = Trim(txtTemplateName.text) 
   Endif
   modDBConnect.BeginTrans()
   modProgressNotes.Templates_Save(template)
   modDBConnect.CommitTrans()
  
  Me.Close(True)

End

Public Sub btnCancel_Click()

  Me.Close

End
Public Sub txtTemplateName_LostFocus()
   
  Last.background = Color.White 
   
End


Public Sub txtTemplateName_GotFocus()

    Last.BackGround = Color.rgb(95, 255, 175)
   

End
