' Gambas class file

Private currentconsult As CConsult
Private currentpregnancy As Collection
Private form_demographics As FPregnancyDemographics
Private form_familyandsocial As FFamilyHistory
Private form_pregnancyhistory As FPregnancyHistory
Private form_firstvisitexamination As FPregnancyFirstExamination
Private frmInvestigations As FPregnancyInvestigations
Private frmProgressNotes As FProgressNotePage
Private form_pasthistory As FPastHistory
Public FrmHTMLViewer As FHtmlViewer 
'----------------
'The wizard pages
'----------------
Private iWizardPageCount As Integer 
Public form_name As String
Public currentForm As Object
Public PreviousForm As Object
Public nextForm As Object

Public Sub Init(c As CConsult, cp As Collection)   
   
   currentconsult = c
   currentpregnancy = cp 
   With form_demographics = New FPregnancyDemographics(VBox_WizardPage)
      .Init(currentConsult)
   End With
   form_familyandsocial = New FFamilyHistory(VBox_WizardPage)
   With form_familyandsocial
      .Init(currentconsult)
      .Visible = False  
   End With
   With form_pregnancyhistory = New FPregnancyHistory(VBox_WizardPage)
      .Visible = False  
   End With
   With frmInvestigations = New FPregnancyInvestigations(VBox_WizardPage)
      .Visible = False  
   End With
   With form_firstvisitexamination = New FPregnancyFirstExamination(VBox_WizardPage)
      .Visible = False
   End With
   With form_pasthistory = New FPastHistory(VBox_WizardPage)
      .Visible = False  
      .Init(currentconsult)
   End With
   form_demographics.visible = True 
   form_pregnancyhistory.Visible = False
   form_firstvisitexamination.Visible = False  
   form_firstvisitexamination.Visible = False  
   form_familyandsocial.visible = False  
   form_demographics.Visible = True  
   PreviousForm = form_demographics
   currentForm = form_demographics
   Nextform = form_familyandsocial
   form_name = "demographics"
   iWizardPageCount = 1
   WizardPage_Notify(1)

End
Public Sub EditAreaButtons_Click()
   
   
   Select Case Last.tag
      ' Case "new"
      '    Pregnancy_New()
      ' Case "save"
      '    Save()
      ' Case "preview"
      '    Preview()
      Case "previous"
         'Go back a form
         'At this point: current form = one we are viewing
         'previous form = form before this one = one we want to view now as going back
         currentForm.Visible = False 
         form_name = currentForm.tag
         Select Case form_name
            Case "Family History"
               currentForm = form_demographics
               nextForm = form_familyandsocial
               lblHeading.text = "DEMOGRAPHIC DETAILS"
            Case "Health Issues"
               currentForm = form_familyandsocial
               nextForm = form_pasthistory
               lblHeading.text = "FAMILY AND SOCIAL HISTORY"
            Case "pregnancy history"
               currentForm = form_pasthistory
               nextForm = form_pregnancyhistory
               lblHeading.text = "PAST HISTORY - EXISTING HEALTH ISSUES"
               form_pregnancyhistory.lblHiddenFocus.SetFocus()
            Case "first examination"
               currentForm = form_pregnancyhistory
               nextForm = frmInvestigations
               lblHeading.text = "THIS PREGNANCY - DATES & PREGNANCY SPECIFIC HEALTH ISSUES"
            Case "investigations"
               currentForm = form_firstvisitexamination
               nextForm = frmInvestigations
               lblHeading.text = "FIRST EXAMINATION"
             ' Case "progress notes"
             '   currentForm = form_visits
             '   nextForm = frmProgressNotes
             '   lBLHeading.TEXT = "ANTENATAL VISITS"
         End Select 
         form_name = currentForm.tag
         currentForm.Visible = True 
         iWizardPageCount = Max(1, (iWizardPageCount - 1))
         WizardPage_Notify(iWizardPageCount)
      Case "next"
         PreviousForm = currentForm              'form being viewed before change now is last form
         PreviousForm.Visible = False 
         currentForm = nextForm
         currentForm.Visible = True 
         form_name = currentForm.tag
         Select Case form_name
            Case "demographics"
               nextForm = form_familyandsocial
               lblHeading.text = "DEMOGRAPHIC DETAILS"
            Case "Family History"
               nextForm = form_pasthistory
               lblHeading.text = "FAMILY And SOCIAL HISTORY"
            Case "Health Issues"
               nextForm = form_pregnancyhistory
               lblHeading.text = "PAST HISTORY - EXISTING HEALTH ISSUES"
            Case "pregnancy history"
               nextForm = form_firstvisitexamination
               lblHeading.text = "THIS PREGNANCY - DATES & PREGNANCY SPECIFIC HEALTH ISSUES"
            Case "first examination"
               nextForm = frmInvestigations
               lblHeading.text = "FIRST EXAMINATION"
            ' Case "investigations"
            '    nextForm = form_visits
               lblHeading.text = "INVESTIGATIONS"
            Case "visits"
               nextForm = frmProgressNotes
               
         End Select 
         iWizardPageCount = Min(7, (iWizardPageCount + 1))
         WizardPage_Notify(iWizardPageCount)
         
   End Select
   
End


Public Sub New_Entry()
   '---------------------------------------------------------------
   'Called from FClinical, called this because can't use New() and
   'all across easyp this is the wording I've chosen
   'see FClinicalToolbar.MainToolbar_Click for details
   '---------------------------------------------------------------   
End
Public Sub WizardPage_Notify(iPage As Integer)
   
   lblWizardPage.text = "  Page " & Str$(ipage) & " of 7  "
   
End
Public Sub Preview()
   '--------------------------------- 
   'Preview the ante-natal-care sheet
   '--------------------------------- 
   
End

Public Sub Save()
   '------------------------------ 
   'Save the ante-natal care sheet
   '------------------------------ 
   form_demographics.Save()
   
   
End
