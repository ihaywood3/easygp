' Gambas class file
' Copyright (C) 2008,2009 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.

Private currentconsult As cConsult
Private bExit As Boolean

Private member As Collection
Private The_Collections As Collection
Private currentPregnancy As collection 
'----------------
'The wizard pages
'----------------
Private iWizardPageCount As Integer 
Public form_name As String
Public currentForm As Object
Public PreviousForm As Object
Public nextForm As Object
Static Private form_pregnancy As FPregnancy
Private frmDemographics As FPregnancyDemographics
Private frmFamilyandsocial As FFamilyHistory
Private frmPregnancyHistory As FPregnancyHistory
Private frmFirstVisitExamination As FPregnancyFirstExamination
Private frmVisits As FPregnancyVisits
Private frmInvestigations As FPregnancyInvestigations
Private frmProgressNotes As FProgressNotePage
Private frmPastHistory As FPastHistory

Public FrmHTMLViewer As FHtmlViewer 

Public Sub Form_Open()
   
End

Public Sub init(cons As cconsult)
   TabStripPregnancy.index = 1
   currentconsult = cons
   'Load pages onto the wizard
   Settings_Load()
   form_pregnancy = Me
   FrmHTMLViewer = New FHtmlViewer(Vbox_LastForm)
   frmDemographics = New FPregnancyDemographics(VBox_WizardPage)
   frmFamilyandsocial = New FFamilyHistory(VBox_WizardPage)
   With frmFamilyandsocial
     .Init(currentconsult)
     .Visible = False  
     .Hbox_FormHeading.Visible = False
   End With
   frmPregnancyHistory = New FPregnancyHistory(VBox_WizardPage)
   frmInvestigations = New FPregnancyInvestigations(VBox_WizardPage)
   frmFirstVisitExamination = New FPregnancyFirstExamination(VBox_WizardPage)
   frmVisits = New FPregnancyVisits(VBox_WizardPage)
   frmProgressNotes = New FProgressNotePage(VBox_WizardPage)
   frmPastHistory = New FPastHistory(VBox_WizardPage)
   With frmPastHistory
      .Visible = False  
      .Init(currentconsult)
      .Vbox_CarePlanning.Visible = False  
      .HSplit_TeamCareMembers.Visible = False   
      .HBox_TeamMembers.Visible = False
      .HBox_Heading.Visible = False
   End With
 
    With frmProgressNotes
      .Init(currentconsult)
      .Visible = False 
      .tag = "progress notes"
      .picBoxHeadingIcon.Visible = False  
      .lblNotesFor.text = "CLINICAL NOTES"
      .lblNotesFor.expand = True 
      .lblNotesFor.Alignment = Align.Center
      .lblNotesFor.Background = Color.ButtonBackground
      .lblNotesFor.Foreground = Color.TextForeground
      .lblPreviousNotes.text = "Last ante-natal visit"
  End With 
  lblHeading.TEXT = "DEMOGRAPHIC DETAILS"
  frmDemographics.visible = True 
   Pregnancy_New()
End


Private Sub Settings_Save()


  

End

Private Sub Settings_Load()


  

End

Public Sub Save()
  
   FClinical.Refresh_AllPreviousNotes()
  
End
Public Sub Preview()
  
  
  
End
Public Sub Pregnancy_New()
   '-----------------------------
   'Start a new health assessment
   '-----------------------------   
   EditArea_Clear()
   currentPregnancy = New collection 
   frmPregnancyHistory.Visible = False
   frmFirstVisitExamination.Visible = False  
   frmProgressNotes.Visible = False 
   frmVisits.Visible = False  
   frmFirstVisitExamination.Visible = False  
   frmFamilyandsocial.visible = False  
   frmDemographics.Visible = True  
  
   PreviousForm = frmDemographics
   currentForm = frmDemographics
   Nextform = frmFamilyandsocial
   form_name = "demographics"
   iWizardPageCount = 1
   WizardPage_Notify(1)
End
  

Public Sub EditArea_Clear()
  
  
  
End

Public Sub EditAreaButtons_Click()

  Select Case Last.tag
  Case "new"
       Pregnancy_New()
  Case "save"
       Save()
  Case "preview"
       Preview()
  Case "previous"
      'Go back a form
      'At this point: current form = one we are viewing
      'previous form = form before this one = one we want to view now as going back
        currentForm.Visible = False 
        form_name = currentForm.tag
       Select Case form_name
            Case "Family History"
             currentForm = frmDemographics
             nextForm = frmFamilyandsocial
             lblHeading.text = "DEMOGRAPHIC DETAILS"
          Case "Health Issues"
             currentForm = frmFamilyandsocial
             nextForm = frmPastHistory
             lblHeading.text = "FAMILY AND SOCIAL HISTORY"
        Case "pregnancy history"
             currentForm = frmPastHistory
             nextForm = frmPregnancyHistory
             lblHeading.text = "PAST HISTORY - EXISTING HEALTH ISSUES"
 
        Case "first examination"
             currentForm = frmPregnancyHistory
             nextForm = frmInvestigations
             lblHeading.text = "THIS PREGNANCY - DATES & PREGNANCY SPECIFIC HEALTH ISSUES"
         Case "investigations"
            currentForm = frmFirstVisitExamination
            nextForm = frmInvestigations
            lblHeading.text = "FIRST EXAMINATION"
      
  
         Case "visits"
           currentForm = frmInvestigations
           nextForm = frmVisits
           lblHeading.text = "INVESTIGATIONS"
         Case "progress notes"
             currentForm = frmVisits
             nextForm = frmProgressNotes
             lBLHeading.TEXT = "ANTENATAL VISITS"
       End Select 
       form_name = currentForm.tag
       currentForm.Visible = True 
       iWizardPageCount = Max(1, (iWizardPageCount - 1))
      WizardPage_Notify(iWizardPageCount)
    Case "next"
       PreviousForm = currentForm              'form being viewed before change now is last form
       PreviousForm.Visible = False 
       currentForm = nextForm
       currentForm.Visible = True 
       form_name = currentForm.tag
       Select Case form_name
        Case "demographics"
          nextForm = frmFamilyandsocial
          lblHeading.text = "DEMOGRAPHIC DETAILS"
        Case "Family History"
            nextForm = frmPastHistory
            lblHeading.text = "FAMILY And SOCIAL HISTORY"
        Case "Health Issues"
            nextForm = frmPregnancyHistory
            lblHeading.text = "PAST HISTORY - EXISTING HEALTH ISSUES"
        Case "pregnancy history"
           nextForm = frmFirstVisitExamination
           lblHeading.text = "THIS PREGNANCY - DATES & PREGNANCY SPECIFIC HEALTH ISSUES"
        Case "first examination"
           nextForm = frmInvestigations
           lblHeading.text = "FIRST EXAMINATION"
        Case "investigations"
          nextForm = frmVisits
           lblHeading.text = "INVESTIGATIONS"
        Case "visits"
            nextForm = frmProgressNotes
            
            End Select 
        iWizardPageCount = Min(7, (iWizardPageCount + 1))
        WizardPage_Notify(iWizardPageCount)
 
  
    End Select
 
End
Public Sub WizardPage_Notify(iPage As Integer)
  
  lblWizardPage.text = "Page " & Str$(ipage) & " of 7"
  
End
