' Gambas class file

' Copyright (C) 2008-2012 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.

Private icounter As Integer 
Private cTableColumn_Date As Integer = 0
Private cTableColumn_duration As Integer = 1
Private cTableColumn_FundalHeight As Integer = 2
Private cTableColumn_Presentation As Integer = 3
Private cTableColumn_FHS As Integer = 4
Private cTableColumn_Urinalysis As Integer = 5
Private cTableColumn_BP As Integer = 6
Private cTableColumn_Weight As Integer = 7
Private cTableColumn_FMF As Integer = 8
Private cTableColumn_Notes As Integer = 9
Private currentconsult As CConsult
Private Presentations As String[]
Private antenatal_visits As Collection

Public Sub Init(c As CConsult)
   
   currentconsult = c  
   Presentations = modPregnancyDBI.Presentations_Get() 
   antenatal_visits = currentconsult!antenatal_visits
   Tableview_Init()
   
End

Private Sub Tableview_Init()
   '--------------------------------------------------
   'Init the tableview headers, default to single row
   '--------------------------------------------------   

   With TableView1
      .Rows.count = antenatal_visits.Count + 1
      .Columns.count = 10
      .Columns[0].text = "     Date     "
      lblMeasure.text = "10/10/2013  "
      .Columns[1].text = "Duration"
      .Columns[2].text = "Fundus (cm)"
      .Columns[3].text = "Presentation"
      .Columns[4].text = " Foetal Heart "
      .Columns[5].text = "Urine"
      .Columns[6].text = "BP"
      .Columns[7].text = "Weight"
      .Columns[8].text = "Movements"
      .Columns[9].text = "Notes"
   End With
   If antenatal_visits.count Then Reload()
   TableView1[tableview1.Rows.max, cTableColumn_Date].text = Format(Now, "dd/mm/yyyy")
   tableview1.column = cTableColumn_duration
   tableview1_click()

End

Private Sub Reload()
   '---------------------------------
   'Display existing ante-natal rows
   '--------------------------------   
   
End

Public Sub TableView1_Click()
   '-----------------------------------------------------------------------
   'User has clicked on a cell in the grid
   'set the edidtor to either a textbox (default) or provide combo-box data
   '-----------------------------------------------------------------------

   Select Case tableview1.column
      Case cTableColumn_Presentation
         TableView1.Edit(Presentations, True)
      Case cTableColumn_FHS
         TableView1.Edit(["Heard", "Not Heard"], True)
      Case cTableColumn_FMF
         TableView1.Edit(["Felt", "Not Felt"], True)
      Case Else
         tableview1.Edit()
   End Select
   
End

Public Sub TableView1_Save(Row As Integer, Column As Integer, Value As String)
   '------------------------------------------------------------------------
   'Move the data from the editing control back into the tableview grid cell
   '------------------------------------------------------------------------

   TableView1[tableview1.row, TableView1.column].text = Value
   
End

Public Sub TableView1_Data(Row As Integer, Column As Integer)
   
End

Public Sub TableView1_Insert()
   '--------------------------------------------------------------
   'User has pressed <ENTER> at the end of a row, insert a new one
   '--------------------------------------------------------------   

   Inc tableview1.Rows.count
   tableview1.column = cTableColumn_Date
   tableview1.row = tableview1.Rows.Max
   TableView1_Click()
   
End

Public Sub Save()
   '------------------------- 
  'Save the ante-natal visit
  '------------------------- 
   
End
