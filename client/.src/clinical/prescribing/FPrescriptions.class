' Gambas class file
' Copyright (C) 2008,2009 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.

Private fk_pasthistory As Integer
Private cProgressNote_Section As Integer
Private currentconsult As CConsult
Private bEmbedded As Boolean             'If true the form is embedded in a frmConsultNotes editor
Private embedded_in_form As String
Private embedded_form As String          'the form this form is embedded in



Public Sub set_embedded(flag As Boolean, embeddedinform As String)
   '--------------------------------------------------
   'If this form is embeded from another form set flag
   'embeddedinform = either "notes" or "documents"
   '--------------------------------------------------
   bEmbedded = flag
   embedded_in_form = embeddedinform
End

Public Sub Save()
  
  
   FClinical.Refresh_AllPreviousNotes()
End

Public Sub TextLabel1_MouseDown()

  

End

Public Sub Form_settings(mode As String)
  
  Select Case mode
    Case "save"
        ' Settings["Tasks_Embedded_" & Parent_Form & "/HSplit_EditArea_Inner.Layout"] = HSplit_EditArea_Inner.Layout
        ' Settings["Tasks_Embedded_" & Parent_Form & "/HSplit_EditArea_Outer.Layout"] = HSplit_EditArea_Outer.Layout
        ' Settings["Tasks_Embedded_" & Parent_Form & "/Vsplit_Script.Layout"] = Vsplit_Script.Layout
    Case "load"
      
  End Select
  
End

Public Sub Init(cons As CConsult)
  
  currentconsult = cons
  
End


Public Sub mnuHealthIssues_Click()
   '---------------------------------------------------
   'User wants to link a request form to a health issue
   'The menu tag = the pk_pasthistory
   '---------------------------------------------------
  
  Select Case Last.tag
  Case "general notes", "remove link"
    txtHealthIssue.text = "General Notes"
    fk_pasthistory = 0
    cProgressNote_Section = const.cSection_GeneralNotes
  Case Else
    txtHealthIssue.text = currentconsult!past_history[Last.tag]!description
    fk_pasthistory = Last.tag
    cProgressNote_Section = const.cSection_Prescriptions
  End Select
End
