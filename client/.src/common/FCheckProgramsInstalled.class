' Gambas class file

' Copyright (C) 2008-2013 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
'----------------------------------------------------------------------
'PURPOSE    At boot up checks that additional programs needed exist on the machine
'---------------------------------------------------------------------------------
Public Support_Programs As String[]
Public Pro As Process
Public bMissingPrograms As Boolean

Public Sub Run() As Boolean
   
   Return Not Me.ShowModal()
   
End

Public Sub btnOK_Click()
   
   Me.Close(bMissingPrograms)
   
End

Public Sub btnCancel_Click()
   
   Me.Close
   
End

Public Sub Form_Open()
   
   Dim PBok As PictureBox
   Dim PBnotOk As PictureBox
   Dim HB As HBox
   Dim Picturebox_Container As HBox
   Dim P As Picture
   Dim spacer As HBox
   Dim lbl As Label
   Dim support_Program As Integer
   Dim x As Integer
   Dim sOutput As String
   
   Support_Programs = New String[4, 2]
   Support_Programs[0, 0] = "mplayer"
   Support_Programs[0, 1] = "plays video files - install mplayer"
   Support_Programs[1, 0] = "wkhtmltopdf"
   Support_Programs[1, 1] = "converts html files to pdf files - install wkhtmltopdf-static binary"
   Support_Programs[2, 0] = "gnuplot"
   support_Programs[2, 1] = "creates graphs - install gnuplot"
   Support_Programs[3, 0] = "pdfjoin"
   support_Programs[3, 1] = "joins pdf - install pdfjam to get this"
   Me.title = "Check Support Programs"
   Me.Center
   
   For x = 0 To Support_Programs.count / 2 - 1
      With HB = New HBox(Vbox1)                  'main horizontal container
         .Height = 24
         .Expand = False  
         .Background = Color.White
         .Spacing = True
      End With
      
      With Picturebox_Container = New HBox(HB)  ' picture box at left hand side of main container
         .H = 24  
         .W = 24
         .Padding = 1
         ' .Background = Color.Black
      End With
      With lbl = New Label(HB)                ' expands to fill the rest of the horizontal container
         .Expand = True   
         .Background = Color.White 
         .text = support_Programs[x, 0] & " - " & support_Programs[x, 1]
      End With
      If Not IsNull(modUtil.FindProgram(support_Programs[x, 0], support_Programs[x, 0], True)) Then  'look for program, but suppress error message
         With pbok = New PictureBox(Picturebox_Container)
            .Picture = Picture.Load("icons/22/ok22x22.png")
            .Visible = True 
            .Expand = True  
            .Stretch = True
         End With
      Else
         With pbNotok = New PictureBox(Picturebox_Container)
            .Picture = Picture.Load("icons/22/delete22x22.png")
            .Visible = True 
            .Expand = True  
            .Stretch = True
            bMissingPrograms = True 
         End With
      End If  
   Next

End
