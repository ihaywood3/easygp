' Gambas class file

' Copyright (C) 2008-2015 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
'------------------------------------------------------------------------------------------
Inherits CTask

Private remote_name As String
Private local_name As String
Private viewer As FDocumentViewer
Private doc_type As String ' image or pdf

Public Sub Set_Viewer(v2 As FDocumentViewer, dt As String)
   
  viewer = v2
  doc_type = dt 
   
End

Public Sub Start_Remote(remote2 As String, local2 As String)
   
  remote_name = remote2
  local_name = local2
  Me.Init(modDBConnect.Scp_Download_Cmd_list(remote_name, local_name)) 
   
End


Public Sub Got_File(s2 As String)
   
  local_name = s2
  Run_Final() 
   
End

Public Sub Run_Final()
   
  If doc_type = "pdf" Then
     viewer.Load_PDF(local_name)
  Else
     viewer.Load_Picture(local_name)
  Endif
   
   
End


