' Gambas class file

Inherits CUrl

Private path As String

Public Sub _new(path1 As String)
   
  path = path1 
   
End

Public Sub PutFile(local As String, fname As String)
   
  Copy local To path &/ fname 
  Raise Uploaded(local)
   
End

Public Sub GetFile(fname As String) As String
   
  Raise Downloaded(path &/ fname)
   
End

Public Sub MoveFile(fname As String, remote As CUrl, Optional remote_fname As String)
   
  If IsNull(remote_fname) Then remote_fname = fname
  If remote.GetHost() = "localhost" Then
     Move path &/ fname To remote.GetPath() &/ remote_fname
  Else
     remote.PutFile(path &/ fname, remote_fname)
  Endif
  
End

Public Sub GetHost() As String
   
  Return "localhost" 
   
End

Public Sub GetPath() As String
   
  Return path 
   
End

Public Sub DeleteFile(fname As String)
   
  Kill path &/ fname 
   
End


Public Sub List()
   
  Raise FileList(Dir(path))
   
End
