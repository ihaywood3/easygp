' Gambas class file

Inherits CUrl

Private host As CSftpHost
Private path As String


Public Sub _new(host1 As CSftphost, path1 As String)
   
  host = host1
  path = path1 
   
End


Public Sub PutFile(local As String, fname As String)
   
  host.PutFile(local, path &/ fname) 
   
End

Public Sub GetFile(fname As String) As String
   
  Return host.GetFile(path &/ fname) 
   
End

Public Sub MoveFile(fname As String, remote As CUrl, Optional remote_fname As String)
  Dim f2 As String
  
  If IsNull(remote_fname) Then remote_fname = fname
  If remote.GetHost() = "localhost" Then
     Move Me.GetFile(fname) To remote.GetPath() &/ remote_fname
  Else
     If Me.GetHost() = remote.GetHost() Then
        host.MoveFile(path &/ fname, remote.GetPath() &/ remote_fname)
     Else
        ' the ole two-step
        f2 = Me.GetFile(fname)
        remote.PutFile(f2, remote_fname)
        Kill f2
     Endif
  Endif
  
End

Public Sub GetHost() As String
   
  Return host.GetHost()
   
End

Public Sub GetPath() As String
   
  Return path 
   
End

Public Sub DeleteFile(fname As String)
   
  host.DeleteFile(path &/ fname)
   
End


Public Sub List() As String[]
   
  Return host.List(path)
   
End
