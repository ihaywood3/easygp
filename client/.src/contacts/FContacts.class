' Gambas class file

' Copyright (C) 2008-2012 Dr. Richard Terry  rterry@pacific.net.au

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
'----------------------------------------------------------------------
' The EasyGP Contacts Manager for people, patients, organisations and employee'
'-------------------------------------------------------------------------------
'This module is only a loader
'puts persons and organisations forms onto a tabbed workspace
'added this line to get the file to commit
'---------------------------------------------------------------------------
Public frmOrganisations As FContactsOrganisations
Public frmPersons As FContactsPersons
Public HelpBrowser As FHtmlViewer
Public cSection_persons As Integer = 1
Static Private form_contacts As Fcontacts  'form_contacts = Me declared in Form_Open()

Static Public Sub Hide_Help()
  form_contacts.SidePanel1.Hidden = True
End

Static Public Sub Show_Help(sPath As String)
 ' form_contacts.SidePanel1.hidden = False
 ' form_contacts.HelpBrowser.WebBrowser1.path = sPath
    
End


Public Sub Form_Open()
   Try FMain.Show_PopUp_Help(False)
   form_contacts = Me
 
'   Settings_Load()
   frmPersons = New FContactsPersons(Vbox_PersonsNotInOrganisations)
   With frmPersons
      .Set_Section(cSection_persons) 'fix me remove one or the other but see settings.
      .Set_Embedded_In_Form("persons")
   End With
   frmOrganisations = New FContactsOrganisations(Vbox_Organisations)
    tabContacts_Click
   

End


Public Sub Form_Close()
 '  Settings_Save()
End

Public Sub Form_Settings(mode As String)
  ' Select Case mode
  ' Case "save" 
  '     Settings["Contacts/Window_Top"] = Me.Top
  '     Settings["Contacts/Window_Left"] = Me.Left
  '     Settings["Contacts/Window_Height"] = Me.Height
  '     Settings["Contacts/Window_Width"] = Me.Width
  ' Case "load"
  '     Me.Top = Settings["Contacts/Window_Top", Me.Top]
  '     Me.Left = Settings["Contacts/Window_Left", Me.Left]
  '     Me.Height = Settings["Contacts/Window_Height", Me.Height]
  '     Me.Width = Settings["Contacts/Window_Width", Me.Width]
  ' End Select
End

Public Sub tabContacts_Click()
  ' lblHeading.text = Replace(TabContacts.Text, "&", "")
'   Select Case TabContacts.Index
'   Case 0
' '   frmPersons.Set_Section(TabContacts.Index)
'   Case 1
'   frmPersons.Set_Section(TabContacts.Index)
'   End Select   

End
