' Gambas class file

' ' Gambas class file
' TS Time stamp   
'  YYYY[MM[DD[HHMM[SS[.S[S[S[S]]]]]]]][ + / - ZZZZ] ^ < degree Of precision >

Public Year_NM As Integer
Public Month_NM As Integer
Public Day_NM As Integer
Public Hour_NM As Integer
Public Minute_NM As Integer
Public Second_NM As Integer
Public TimeStamp As Date

Public Sub Emit(dest As Stream)
   
   If IsNull(TimeStamp) Then 
      If Year_NM = 0 Then 
         Return
      Else
         modHL7Emitter.Emit("", dest, [Format$(Year_NM, "0000"), Format$(Month_NM, "00"), Format$(Day_NM, "00"), Format$(Hour_NM, "00"), Format$(Minute_NM, "00"), Format$(Second_NM, "00"), "+1000"])
      Endif
   Else
      modHL7Emitter.Emit("", dest, [Format(TimeStamp, "yyyymmddhhnnss"), "+1000"])
      
   Endif
   
End
