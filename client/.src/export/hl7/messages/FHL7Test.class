' Gambas class file

Public Sub Button1_Click()

Dim message As New CHL7MessageTransferPatient
Dim ReceivingFacility As CHL7Datatype_HD
Dim ConsultingDoctor As CHL7Datatype_XCN
Dim ReferralLetterText As String
Dim TempFile As File 'just for testing
Dim sLine As String 'just for testing
Dim AdmissionType As String
ConsultingDoctor = New CHL7Datatype_XCN
ReceivingFacility = New CHL7Datatype_HD

ConsultingDoctor.ProviderNumber = "xy4567896"
ConsultingDoctor.GivenName = "Friedel"
ConsultingDoctor.FamilyName = "Schmitt"
' ConsultingDoctor.IdentifyerTypeCode
ConsultingDoctor.AssigningAuthority.ApplicationIdentifier = "AUSHICPR"
ConsultingDoctor.NameTypeCode = "L"

ReceivingFacility.ApplicationIdentifier = "MedicalCenterXY"

TempFile = Open "/home/bernd/svn/easygp/referraltext"
While Not Eof(TempFile)
  Line Input #TempFile, sLine
  ReferralLetterText = ReferralLetterText & sLine & "\n"
Wend

AdmissionType = "R"  'A  = ACCIDENT   E = EMERGENCY L = LABOR  R = ROUTINE 
message.CreateHL7Message_TransferPatient(ConsultingDoctor, ReceivingFacility, 1, ReferralLetterText, AdmissionType)

End 
