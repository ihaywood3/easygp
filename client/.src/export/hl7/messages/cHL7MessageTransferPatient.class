' Gambas class file

' 
' Function to fill all required fields for the message
' 

Public Sub CreateHL7Message_TransferPatient(CunsultingDoctor_XCN As CHL7Datatype_XCN, ReceivingFacility_HD As CHL7Datatype_HD, ToTransferPatient_fk_Patient As Integer)
   
   Dim MSH As CHL7Segment_MSH
   Dim PID As CHL7Segment_PID
   Dim PV1 As CHL7Segment_PV1
   Dim ORC As CHL7Segment_ORC
   Dim OBR As CHL7Segment_OBR
   Dim OBX1 As CHL7Segment_OBX
   Dim OBX2 As CHL7Segment_OBX
   Dim OBX3 As CHL7Segment_OBX
   Dim OBX4 As CHL7Segment_OBX
   Dim OBX5 As CHL7Segment_OBX
   Dim OBX6 As CHL7Segment_OBX
   Dim OBX7 As CHL7Segment_OBX
   
   Dim UserInformation As Collection
   Dim Patient As Collection
   Dim MSH_String As String
   Dim PID_String As String 
   Dim PV1_String As String
   Dim ORC_String As String
   Dim OBR_String As String
   Dim OBX1_String As String
   Dim OBX2_String As String
   Dim OBX3_String As String
   Dim OBX4_String As String
   Dim OBX5_String As String
   Dim OBX6_String As String
   Dim OBX7_String As String
   
   
   MSH = New CHL7Segment_MSH
   PID = New CHL7Segment_PID
   PV1 = New CHL7Segment_PV1
   ORC = New CHL7Segment_ORC
   OBR = New CHL7Segment_OBR
   OBX1 = New CHL7Segment_OBX
   OBX2 = New CHL7Segment_OBX
   OBX3 = New CHL7Segment_OBX
   OBX4 = New CHL7Segment_OBX
   OBX5 = New CHL7Segment_OBX
   OBX6 = New CHL7Segment_OBX
   OBX7 = New CHL7Segment_OBX
   
   UserInformation = New Collection
   
   UserInformation = modDBConnect.currentUser
   Patient = modContactsDBI.Patient_Get_Using_PK(ToTransferPatient_fk_Patient)
   
   MSH.FillWithData(ReceivingFacility_HD, "ADT^A02")
   PID.FillWithData(Patient)
   PV1.FillWithData(UserInformation)
   ORC.FillWithData("controlcodestring")
   OBR.FillWithData()
   OBX1.FillWithData()
   OBX2.FillWithData()
   OBX3.FillWithData()
   OBX4.FillWithData()
   OBX5.FillWithData()
   OBX6.FillWithData()
   OBX7.FillWithData()

   
   MSH_String = MSH.GetString(MSH)
   PID_String = PID.GetString(PID)
   PV1_String = PV1.GetString()
   ORC_String = ORC.GetString()
   OBR_String = OBR.GetString()
   OBX1_String = OBX1.GetString()
   OBX2_String = OBX2.GetString()
   OBX3_String = OBX3.GetString()
   OBX4_String = OBX4.GetString()
   OBX5_String = OBX5.GetString()
   OBX6_String = OBX6.GetString()
   OBX7_String = OBX7.GetString()
   
End


