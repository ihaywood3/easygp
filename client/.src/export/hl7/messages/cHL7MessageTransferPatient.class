' Gambas class file

' 
' Function to fill all required fields for the message
' 

Public Sub CreateHL7Message_TransferPatient(CunsultingDoctor_XCN As CHL7Datatype_XCN, ReceivingFacility_HD As CHL7Datatype_HD, ToTransferPatient_fk_Patient As Integer)
   
   Dim MSH As CHL7Segment_MSH
   Dim PID As CHL7Segment_PID
   Dim PV1 As CHL7Segment_PV1
   Dim UserInformation As Collection
   Dim Patient As Collection
   Dim MSH_String As String
   Dim PID_String As String 
   Dim PV1_String As String
   
   MSH = New CHL7Segment_MSH
   PID = New CHL7Segment_PID
   PV1 = New CHL7Segment_PV1
   UserInformation = New Collection
   
   UserInformation = modDBConnect.currentUser
   Patient = modContactsDBI.Patient_Get_Using_PK(ToTransferPatient_fk_Patient)
   
   MSH.FillWithData(ReceivingFacility_HD, "ADT^A02")
   PID.FillWithData(Patient)
   PV1.FillWithData(UserInformation)
   
   MSH_String = MSH.GetString(MSH)
   PID_String = PID.GetString(PID)

End


