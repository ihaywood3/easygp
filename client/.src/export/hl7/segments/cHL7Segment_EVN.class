' Gambas class file

' 
' EVN - Event type segment
' 
' The EVN segment specifies the type Of Event contained within the message.Not all HL7 messages will include the EVN.
' 
' variable declaration
Public SegmentID_ID_Req As String = "EVN"
Public EventTypeCode_ID_Req As String
Public RecordedDateTime_TS_Req As New CHL7Datatype_TS
Public PlannedEventDateTime_TS_Opt As New CHL7Datatype_TS
Public EventReasonCode_Is_Opt As String
Public OperatorID_CN_Opt As New CHL7Datatype_CN
Public EventOccurred_TS_Opt As New CHL7Datatype_TS

Public Sub _new(EventTypeCode As String, Optional Operator As Collection, Optional EventReasonCode As String)
   
   EventTypeCode_ID_Req = EventTypeCode
   
   RecordedDateTime_TS_Req.TimeStamp = Now
   
   If Not IsNull(Operator) Then
   OperatorID_CN_Opt.FamilyName = Operator["surname"] 
   OperatorID_CN_Opt.GivenName = Operator["firstname"]
   OperatorID_CN_Opt.Prefix = Operator["title"]
   'fix me 
   'if operatorID is included a source table must be included as well
   'operatorID_CN_Opt.SourceTable = ? 
   
   
   Endif

End

Public Function Emit(dest As Stream)
            modHL7Emitter.Emit("|", dest, [SegmentID_ID_Req, EventTypeCode_ID_Req, RecordedDateTime_TS_Req, PlannedEventDateTime_TS_Opt, EventReasonCode_Is_Opt,
      OperatorID_CN_Opt, EventOccurred_TS_Opt])
End
