' Gambas class file

'Variable name : Variablecontent_DataType_Required(Req)orOptional(Opt)
' 
' TODO:
' 
' Set Function For Each Optional variable To make this vatiale accessable form the outside And To be able To controll the value taht has To be set that it Is A proper value For this variable(syntax etc)


Public SegmentID_ST_Req As String = "MSH"
Public SendingApplication_HD_Opt As New CHL7Datatype_HD
Public SendingFacility_HD_Opt As New CHL7Datatype_HD
Public ReceivingApplication_HD_Opt As New CHL7Datatype_HD
Public ReceivingFacility_HD_Opt As New CHL7Datatype_HD
Public MessageDateTime_TS_Opt As New CHL7Datatype_TS
Public Security_ST_Opt As String
Public MessageType_ST_Req As String
Public MessageControlID_ST_Req As String
Public ProcessingID_PT_Req As New CHL7Datatype_PT
Public VersionID_ID_Req As String
Public SequenceNumber_NM_Opt As Integer
Public ContinuationPointer_ST_Opt As String
Public AcceptAcknowledgmentType_ID_Opt As String
Public ApplicationAcknowledgmentType_ID_Opt As String
Public CoountryCode_ID_Opt As String
Public CharacterSet_ID_opt As String
Public PrincipalLanguageOfMessage_CE_Opt As CHL7Datatype_CE

Public Sub _new()
   
  Dim UserInformation As Collection
  
  MessageDateTime_TS_Opt.mydate = Now
  SendingApplication_HD_Opt.ApplicationIdentifier = "EasyGP/" & Application.Version
  ProcessingID_PT_Req.ProcessingID = "P" 
  VersionID_ID_Req = "2.3.1"
  UserInformation = modDBConnect.currentUser 
  SendingFacility_HD_Opt.ApplicationIdentifier = UserInformation!organisation

End




Public Function Emit(dest As Stream)
  

  Print #dest, "MSH|^~\\&|";
  modHL7Emitter.Emit("|", dest, [SendingApplication_HD_Opt, SendingFacility_HD_Opt, ReceivingFacility_HD_Opt, MessageDateTime_TS_Opt, MessageType_ST_Req, MessageControlID_ST_Req, ProcessingID_PT_Req, VersionID_ID_Req])
  Print #dest, "|||||Aus"; 

End
