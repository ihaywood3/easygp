' Gambas class file

' Copyright (C) 2012 Bernd Brinkmann brinkmann_bernd@gmx.de

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
'----------------------------------------------------------------------

Public SetID_NM As Integer
Public PlacerOrderNumber_ST As String
Public FillerOrderNumber_ST As String
Public UniversalServiceID_CE As New CHL7Datatype_CE
Public ObservationEndDateTime As New CHL7Datatype_TS
Public CollectorIdentifier_XCN As New CHL7Datatype_XCN
Public SpecimenActionCode_ST As String
Public RelevantClinicalInfo_ST As String
Public SpecimenReceivedDateTime_TS As New CHL7Datatype_TS
Public SpecimenSource_ST As String
Public OrderingProvider_XCN As New CHL7Datatype_XCN
Public OrderCallBackPhoneNmber_XTN As New CHL7Datatype_XTN
Public PlacerField1_ST As String
Public PlacerField2_ST As String
Public FillerField1_ST As String
Public FillerField2_ST As String
Public ReportingDateTime_TS As New CHL7Datatype_TS
Public DiagnosticServiceSectionID_ST As String
Public ResultStatus_ST As String
Public QuantityTiming_TQ As New CHL7Datatype_TQ
Public ResutCopiesTo_XCN As New CHL7Datatype_XCN
Public TransportationMode_ST As String
Public ReasonForStuy_CE As New CHL7Datatype_CE
Public PrincipalResultInterpreter_ST As String
Public AssistantResultInterpreter As String

Public Sub _new(SetID As Integer)
   '-------------------------------
   'this function is called when a new EVN object of this class is created and it automatically fills 
   'this object with all the required data
   'Variables:
   '-SetID: has to be an integer that says how many OBR segments are existing in this message
   '--------------------------------
   
   Dim UserInformation As New Collection
   
   UserInformation = modDBConnect.currentUser
   SetID_NM = SetID
   
   '    RelevantClinicalInfo_ST = 'Letter from the doctor can not be more than 300 bytes 
   
   ' only used for laboratory orders etc.
   ' UniversalServiceID_CE.Identifier = "LAB"
   ' UniversalServiceID_CE.NameOfAlternateCodingSystem = "AUSNATA" 'Australian NATA ( National Association of Testing Authoriies)
   ' UniversalServiceID_CE.AlternateIdentifier
   
End

Public Function Emit(dest As Stream)
   '----------------------------------------------------------------------
   'This function puts the information contained by this class object into HL7 format
   'Variables:
   '-dest:  a stream variable where the result will be written to 
   '----------------------------------------------------------------------
   '
   'fix me: 
   'this segment has not been used so far if it is needed this function needs to be completed
   '
   
   modHL7Emitter.Emit("|", dest, [])
   
End
