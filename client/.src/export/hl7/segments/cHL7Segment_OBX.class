' Gambas class file

' Copyright (C) 2012 Bernd Brinkmann brinkmann_bernd@gmx.de

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
'----------------------------------------------------------------------

Public SetID As Integer
Public ValueType_ID As String
Public ObservationIdentifier_CE As New CHL7datatype_CE
Public ObservationSubID_ST As String
Public ObservationValue_ST As String
Public Units_CE As New CHL7datatype_CE
Public ReferenceRange_ST As String
Public AbnormalFlags_ST As String
Public Probability_NM As String
Public NatureOfAbnormalTest_ST As String
Public ObservationResultStatus_ST As String
Public DateLastObsNormalValues_TS As New CHL7datatype_TS
Public userDefinedAccessChecks_ST As String
Public DateTimeOfTheObservation_TS As New CHL7datatype_TS
Public ProducersID_CE As New CHL7datatype_CE

Public Sub _new(ID As Integer, ValueType As String, ObservationIdentifier As CHL7Datatype_CE, ObservationResultStatus As String, Optional LetterText As String)
   '-------------------------------
   'this function is called when a new EVN object of this class is created and it automatically fills 
   'this object with all the required data
   'Variables:
   '-ID: has to be an integer that says how many OBX segments are existing in this message
   '-ValueType: needs to be a string that is coded according to the HL7 TABLE 125 - VALUE TYPE
   '-ObsercationIdentifier: has to be a cHL7Datatype_CE class object and contains information about the content of this segment
   '-ObservationResultStatus: has to be a string coded according to the HL7 TABLE 85 - OBSERVATION RESULT STATUS CODES INTERPRETATION
   '-LetterText(optional): has to be a string containing a letter for the receiver of this message
   '--------------------------------
   
   ValueType_ID = ValueType
   SetID = ID
   ObservationValue_ST = LetterText
   ObservationIdentifier_CE = ObservationIdentifier
   ObservationResultStatus_ST = ObservationResultStatus
   
End

Public Function Emit(dest As Stream)
   '----------------------------------------------------------------------
   'This function puts the information contained by this class object into HL7 format
   'Variables:
   '-dest:  a stream variable where the result will be written to 
   '----------------------------------------------------------------------
   '
   
   modHL7Emitter.Emit("|", dest, ["OBX", SetID, ValueType_ID, ObservationIdentifier_CE, ObservationSubID_ST, ObservationValue_ST, Units_CE, 
      ReferenceRange_ST, AbnormalFlags_ST, Probability_NM, NatureOfAbnormalTest_ST, ObservationResultStatus_ST, DateLastObsNormalValues_TS,
      userDefinedAccessChecks_ST, DateTimeOfTheObservation_TS, ProducersID_CE])
   
End
