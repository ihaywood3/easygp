' Gambas class file

Public SetID As Integer
Public ValueType As String
Public ObservationIdentifier_CE As New CHL7datatype_CE
Public ObservationSubID_ST As String
Public ObservationValue_ST As String
Public Units_CE As New CHL7datatype_CE
Public ReferenceRange_ST As String
Public AbnormalFlags_ST As String
Public Probability_NM As String
Public NatureOfAbnormalTest_ST As String
Public ObservationResultStatus_ST As String
Public DateLastObsNormalValues_TS As New CHL7datatype_TS
Public userDefinedAccessChecks_ST As String
Public DateTimeOfTheObservation_TS As New CHL7datatype_TS
Public ProducersID_CE As New CHL7datatype_CE

Public Sub _new(ID As Integer, Optional ReferralLetterText As String)

SetID = ID
         ObservationValue_ST = ReferralLetterText
End

Public Function Emit(dest As Stream)
   
  modHL7Emitter.Emit("|", dest, ["OBX", SetID, ValueType, ObservationIdentifier_CE, ObservationSubID_ST, ObservationValue_ST, Units_CE, 
  ReferenceRange_ST, AbnormalFlags_ST, Probability_NM, NatureOfAbnormalTest_ST, ObservationResultStatus_ST, DateLastObsNormalValues_TS,
  userDefinedAccessChecks_ST, DateTimeOfTheObservation_TS, ProducersID_CE])

   
End
  
