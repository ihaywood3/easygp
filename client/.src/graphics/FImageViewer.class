' Gambas class file

Private Form_Magnify As FMagnify
Private Pictures As Collection
Private Picture As Collection

Private currentconsult As CConsult

Public Sub Init(cons As CConsult)
   currentconsult = cons
   Form_Magnify = New FMagnify(VBox_DisplayArea)
   Reload()
End

Public Sub Reload()
   Dim PB As PictureBox
   Dim Pic As Picture
   Dim HB As HBox
   
  Pictures = modImagesDBI.Patient_Images_Get(currentconsult!patient!fk_patient) 
  For Each picture In Pictures
   Pic = modGraphics.Blob_Convert_To_Picture(picture!image)
   With HB = New HBox(ScrollView1)
      .width = 100
      .background = Color.White
      .padding = 2 
   End With
   With PB = New PictureBox(HB)
     .Picture = Pic
     .Stretch = True 
     .Width = 100
   End With
 Next
End

