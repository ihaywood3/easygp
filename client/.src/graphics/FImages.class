' Gambas class file

Private images As Collection
Private image As Collection

Public Sub Form_Open()

   images = modDBConnect.exec_query_collection("Select pk, consult_date from blobs.vwPatientimages order by consult_date")
   For Each image In images
      If Not IsNull(image!consult_date) Then
         listview1.Add(image!pk, Format(image!consult_date, "dd/mm/yyyy"))
      End If
   Next

End

Public Sub ListView1_Select()

   Dim P As Picture
   Dim R As Result

   R = modDBConnect.exec_query("select * from blobs.vwPatientImages where pk= " & listview1.Item.key)
   If R.count Then
      PictureBox1.Picture = modGraphics.Blob_Convert_To_Picture(R!image)!picture
      textbox1.text = "fk_patient:" & Str$(R!fk_patient)
   End If

End
