' Gambas class file
' Copyright (C) 2008,2009 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
Private cTowns As collection
Public Sub Run() As Boolean

  Return Not Me.ShowModal()

End

Public Sub btnOK_Click()

  Me.Close(True)

End

Public Sub btnCancel_Click()

  Me.Close

End
Public Sub Form_Open()
  
  Dim f As New frmLogon
  
  f.ShowModal()
  
End
Public Sub Org_Suburb_Select() 'FIX ME TEMP CODE TO SEE IF WORKS
      ' '--------------------------------------------------------------
      ' 'just a temporary note:
      ' 'havinga problems with lcaddresses.item.key
      ' 'the iCurrentAddress should always be the on-row value of this
      ' 'unless it is new address in which case set to 0
      ' 'when the town is selected the the fk_town is saved
      ' 'all the other values set by the change event for the value
      ' 'eg see txtstreet_change
      ' '--------------------------------------------------------------
      ' Dim iTemp As Integer
      ' itemp = CStr(Val(lvwPopupOrganisations.key) + 1)
      ' txtSuburb.text = cTowns[itemp].suburb
      ' txtState.text = cTowns[itemp].state 
      ' txtPostcode.text = cTowns[itemp].postcode
      ' currentBranch.address.fk_town = cTowns[itemp].fk_town
      ' currentBranch.address.suburb = cTowns[itemp].suburb
      ' currentBranch.address.state = cTowns[itemp].state
      ' currentBranch.address.postcode = cTowns[itemp].postcode
      ' currentBranch.address.country_code = "AU" 'FIXME
      ' If chkHeadOffice.Enabled = True Then
      '    chkHeadOffice.SetFocus()
      ' Else
      '    chkPostal.SetFocus()
      ' End If
  End
Public Sub lvwPopupOrganisations_DblClick()
       ' Select Case Last.Tag
       '   
       '    Case "suburb"
       '              Org_Suburb_Select
       ' 
       '    End Select
       '    lvwPopupOrganisations.Hide
       ' 
End
Public Sub Address_KeyRelease()
   ' 
   ' Dim $TownResult As Result
   ' Dim address As cAddress
   ' Dim strResult As String
   ' 
   ' Dim i As Integer
   '   i = 1 'FIX ME PUT IN PROPER INDEX IN FIRSTNAMES
   ' 'Print "should be in here now"
   '  Select Case Last.tag
   '    Case "suburb"
   '      '----------------------------------------------------------------
   '      'Load all the towns like txtSuburb into the popup listview2
   '     'at the same time, all the $Result results are stored in the
   '     'cTowns collection to be used when user clicks on selected
   '     'town in the popup listbox
   '     '------------------------------------------------------------
   '    ' ' Print "doing the ORGANISATION suburb thing"
   '              If Len(txtSuburb.text) = 0 Then  'user deletes suburb, delete everything else
   '                       txtState.Text = ""
   '                       txtPostcode.text = ""
   '                       cTowns.Clear
   '                       Return
   '              End If
   '              'Print "looking for suburb"
   '              'Now get the list of towns
   '              $TownResult = modContactsDBI.get_town(Lower(Trim$(txtSuburb.text)))
   '              If $TownResult.count Then 
   '                  lvwPopupOrganisations.Clear
   '                  lvwPopupOrganisations.Raise()
   '                  lvwPopupOrganisations.tag = txtSuburb.tag     'see list2_keypress for why
   '                  For Each $TownResult 
   '                           address = New cAddress
   '                           strResult = $TownResult!town & " " & $TownResult!State & " " & $TownResult!Postcode
   '                           lvwPopupOrganisations.Add(CStr(i), strResult)
   '                           address.fk_town = $TownResult!pk
   '                           address.suburb = $TownResult!town
   '                           address.postcode = $TownResult!Postcode
   '                           address.state = $TownResult!State
   '                           Inc i
   '                           'Print i, "town added", $TownResult!town
   '                           cTowns.Add(address, CStr(i))
   '                    Next 
   '                    If $TownResult.count = 1 Then 
   '                           lvwPopupOrganisations_DblClick
   '                    Else 
   '                             lvwPopupOrganisations.Visible = True
   '                             lvwPopupOrganisations.Raise
   '                             'Print "should be raised now"
   '                    End If
   '                End If
   ' End Select 

End
