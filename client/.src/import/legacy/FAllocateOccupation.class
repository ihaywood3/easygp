' Gambas class file

Public Sub Init(occ As String)
   
  TextLabel1.text = "Please verify the spelling of this occupation" 
  txtOccupationNew.text = occ
End

Public Sub Run() As Boolean

   Return Not Me.ShowModal()

End

Public Sub btnOK_Click()
   Dim mso As CRow
   
   If txtOccupationVerified.text = "" Then 
      txtOccupationVerified.SetFocus()
      Return
   Endif                                                       
   '-----------------------------------------------------------
   'if the verified occupation spelling different to that found
   ' in the table putting the data into this field
   'save this as a probable mis-spelt occupation
   '-----------------------------------------------------------
   If modUtil.StripExtraBlanks(txtOccupationVerified.text) <> Trim(txtOccupationNew.text) Then    
      mso = New CRow
      mso!occupation = Lower(modUtil.StripExtraBlanks(txtOccupationVerified.text))
      mso!misspelt_occupation = Lower(Trim(txtOccupationNew.text))
      mso.Save("import_export.lu_misspelt_occupations", "fk_lu_misspelt_occupations")
      modDBConnect.CommitTrans()
   End If   
   const.globalstring = Lower(modUtil.StripExtraBlanks(txtOccupationVerified.text))
   Me.Close(True)

End

Public Sub btnCancel_Click()
   const.globalstring = ""
   Me.Close

End


