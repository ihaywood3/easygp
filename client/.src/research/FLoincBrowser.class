' Gambas class file

Private systems As Collection
Private system As String
Private loinc_codes As collection  
Public Sub Form_Open()
  
  Init()
  
End
Public Sub Init()
  systems = modUtil.LoadCombo(cmbSystems, modResearchDBI.Loinc_Systems_Get(), "system")
  cvwLoincTerms.Columns.count = 3
  cvwLoincTerms.Columns[0].width = 200
End


Public Sub cmbSystems_Click()
  Dim code As collection 
  Dim x As Integer

   loinc_codes = modResearchDBI.Get_Loinc_Codes(cmbSystems.text, Trim(txtComponent.text))
  cvwLoincTerms.Clear()
  For Each code In loinc_codes
      cvwLoincTerms.Add(code!pk, 0)
      cvwLoincTerms[code!pk][0] = code!loinc_num
      cvwLoincTerms[code!pk][1] = code!component
      cvwLoincTerms[code!pk][2] = code!system
 '  Inc x
   Next
End


Public Sub txtComponent_KeyRelease()

   cmbSystems_Click()

End

Public Sub cmbSystems_Change()

   

End
