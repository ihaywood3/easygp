' Gambas class file

Private FHealthIssues As FHealthIssuesResearch
Private FLoinc As FLoincBrowser
Private FCodingSystems As FCodingSystemsBrowser
Private form_diabetes_research As FDiabetesResearch
Private form_bp_research As FResearchHypertension
Private Health_Issue_Research As FHealthIssuesResearch
Private form_practice_profile As FPracticeProfile

Private Const cTab_Diabetes As Integer = 0
Private Const cTab_Documents As Integer = 1
Private Const cTab_Graphs As Integer = 2
Private Const cTab_BloodPressure As Integer = 3
Private Const cTab_Practice_Profile As Integer = 4
Private Form_Document_Research As FResearchPathology
Private form_queries As FQueries

Public Sub Form_Open()
   
   Init()
   
End

' Create Or REPLACE VIEW research.vwfentanylpatients As 
'  Select DISTINCT vwpatients.firstname,
'     vwpatients.surname,
'     vwpatients.nursing_home_resident
'    From clin_prescribing.vwprescribeditems,
'     contacts.vwpatients
'   WHERE vwprescribeditems.fk_patient = vwpatients.fk_patient And vwprescribeditems.generic ~~* '%fentanyl%'::text AND vwprescribeditems.active = true AND vwpatients.active_status = 'active'::text AND vwpatients.deceased = false;
' 
' ALTER TABLE research.vwfentanylpatients
'   OWNER To richard;

Public Sub Init()
   '  FHealthIssues = New FHealthIssuesResearch(VBox_HealthIssues)   'will put these in later when developed.
   '  FLoinc = New FLoincBrowser(Vbox_Loinc)
   ' FCodingSystems = New FCodingSystemsBrowser(Vbox_CodingSystems)
   '  f_Query = New FQuery(VBox_Query)
   
   With form_diabetes_research = New FDiabetesResearch(VBox_DiabetesResearch)
     .Init()
   End With

   form_queries = New FQueries(VBoxQueries)

End

Public Sub Settings_Save()
   
   Try form_diabetes_research.Settings_Save()
   
End

Public Sub VBox_HealthIssues_MouseDown()
   
End

Public Sub TabStrip1_Click()
   
   Select Case TabStrip1.Index
         
      Case cTab_Documents
         If IsNull(Form_Document_Research) Then
            With Form_Document_Research = New FResearchPathology(Vbox_DocumentResearch)
               .Init()
            End With
         Endif
      Case cTab_BloodPressure
      If IsNull(form_bp_research) Then 
         form_bp_research = New FResearchHypertension(Vbox_BLoodPressure)
      Endif
      Case cTab_Practice_Profile
         If IsNull(form_practice_profile) Then
            form_practice_profile = New FPracticeProfile(Vbox_Practice_Profile)
         Endif
   End Select
End

Public Sub rbText_Click()

   

End
