' Gambas class file

' Gambas class file
' Copyright (C) 2008-2011 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
'----------------------------------------------------------------------
' PURPOSE      A form to set global font and color preferences
'              FIXME rename me
'----------------------------------------------------------------------
Private FHelp As FHtmlViewer
Private help_dir As String

Public Sub Init()
   
   With FHelp = New FHtmlViewer(Vbox_Help)
      .tbWebBrowserZoomIn.Visible = True
      .tbWebBrowserZoomOut.Visible = True  
   End With
   help_dir = Application.Path &/ "help/"
   modEditAreaHelpers.Help_Show("user-preferences-fonts-and-colors.html", FHelp)
   Try Settings_Load()
   Fonts_Adjust()
   
End

Private Sub Settings_Load()
   
   HSplit1.Layout = Settings["User Preferences" & modDBConnect.currentUser!logon_name & "/HSplit1.layout"]
   txtApplicationFont.text = Settings["User Preferences" & modDBConnect.currentUser!logon_name & "/Application.Font"]
   txtSideBarFont.text = Settings["User Preferences" & modDBConnect.currentUser!logon_name & "/SideBarFont.Font", FMain.Get_Sidebar_Font()]
   ColorChooser1.value = Settings["" & modDBConnect.currentUser!logon_name & "/Background_Color", 5737869]
   FHelp.WebView1.Zoom = Settings["User Preferences" & modDBConnect.currentUser!logon_name & "/Help_Zoom"]

End

Public Sub Settings_Save()
   
   Settings["User Preferences" & modDBConnect.currentUser!logon_name & "/HSplit1.layout"] = HSplit1.Layout 
   Settings["User Preferences" & modDBConnect.currentUser!logon_name & "/Help_Zoom"] = FHelp.WebView1.Zoom

End 

Private Sub Fonts_Adjust()
   
   lblMeasure.text = "  Application Font  "
   modEditAreaHelpers.Resize_labels(Vbox_EditArea, lblMeasure)
   
End

Public Sub btnFonts_Click()

   Dim sidebarfont As New Font 

   Select Last.tag
      Case "global font"
         Try Application.font = modUtil.Change_Fonts(Application.font)
         If Not Error Then 
            txtApplicationFont.text = Application.font.ToString()
            Settings["User Preferences" & modDBConnect.currentUser!logon_name & "/Application.Font"] = Application.Font.ToString()
            FClinical.FormFonts_Adjust()
            Fonts_Adjust()
         End If
      Case "side bar font"  
         
         Try sidebarfont = modUtil.Change_Fonts(Font[txtSideBarFont.text])
         If Not Error Then 
            txtSideBarFont.text = sidebarfont.ToString()
            Settings["User Preferences" & modDBConnect.currentUser!logon_name & "/SideBarFont.Font"] = sidebarfont.ToString()
            FMain.Set_SideBar_Fonts(sidebarfont)
         End If
   End Select
   
End

Public Sub ColorChooser1_Change()
   
   FMain.Adjust_Colors(Last.value)
   Settings["User Preferences" & modDBConnect.currentUser!logon_name & "/Background_Color"] = Last.value
   
End
