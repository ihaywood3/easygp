' Gambas class file

Private FHelp As FHtmlViewer
Private help_dir As String 
Private bExit As Integer 
Private Settings_Section As String 
Private bShowPatientPicture As Boolean
Private bPatientListUsePhotoID As Boolean
Private bPatientForceConfirm As Boolean

Public Sub Init()
   '------------------------------------------------
   'Load a html viewer to view help files if needed
   'the default provider type is undefined
   '------------------------------------------------
   
   With FHelp = New FHtmlViewer(Vbox_Help)
      .tbWebBrowserZoomIn.Visible = True
      .tbWebBrowserZoomOut.Visible = True  
   End With
   lblMeasure.text = "  Enforce Confirm Identity  "
   modEditAreaHelpers.Resize_labels(Vbox_EditArea_Inner, lblMeasure)
   help_dir = Application.Path &/ "help/"
   modEditAreaHelpers.Help_Show("general-staff-preferences.html", FHelp)
   Settings_Section = "Preferences_FStaffGeneralPreferences_" & ModDBConnect.userName()
   Try Settings_Load()   
   
End 

Public Sub Settings_Save()
   
   Settings[Settings_Section & "/HSplit_Main.Layout "] = HSplit_Main.layout
   Settings[Settings_Section & "/Help_Zoom"] = FHelp.WebView1.Zoom
   Settings[Settings_Section & "/Clinical_ShowPatientPicture"] = bShowPatientPicture
   Settings[Settings_Section & "/Clinical_UsePatientListPhotoID"] = bPatientListUsePhotoID
   Settings[Settings_Section & "/Clinical_PatientIdentifyConfirm"] = bPatientForceConfirm

End

Private Sub Settings_Load()
    bExit = True
   Try HSplit_Main.layout = Settings[Settings_Section & "/HSplit_Main.Layout", [1, 1]] 
   Try FHelp.WebView1.Zoom = Settings[Settings_Section & "/Help_Zoom"]
   Try bShowPatientPicture = Settings[Settings_Section & "/Clinical_ShowPatientPicture"]
   Try bPatientListUsePhotoID = Settings[Settings_Section & "/Clinical_UsePatientListPhotoID"]
   Try bPatientForceConfirm = Settings[Settings_Section & "/Clinical_PatientIdentifyConfirm"]
   chkShowPatientPicture.value = bShowPatientPicture
   If bPatientListUsePhotoID Then
      rbSimpleList.value = False
      rbPhotoID.Value = True   
   Else
      rbSimpleList.value = True
      rbPhotoID.Value = False   
   End If
   If bPatientForceConfirm Then
      rbConfirmIdentityYes.value = True
   Else
      rbConfirmIdentityYes.value = False
    End If  
   bExit = False  
End

Public Sub EditAreaCheckBox_Click()
   If bExit Then Return 
   Select Case Last.tag
      Case "show patient picture"
         If Last.value = True Then
            bShowPatientPicture = True
         Else
            bShowPatientPicture = False 
         End If    
   End Select
   
   Settings_Save()
   
End

Public Sub rbEditArea_Click()
   If bexit Then Return 
   Select Case Last.tag
      Case "simple list"
         bPatientListUsePhotoID = False
      Case "photo id"
         bPatientListUsePhotoID = True 
      Case "confirm yes"
         bPatientForceConfirm = True
      Case "confirm no"
         bPatientForceConfirm = False  
   End Select
   Settings_Save()
   
End
