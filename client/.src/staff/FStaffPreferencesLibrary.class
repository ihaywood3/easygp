' Gambas class file

'
' Copyright (C) 2008-11 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
'---------------------------------------------------------------------------------
'PURPOSE    Allow user to set their peferences for how the library section behaves
'---------------------------------------------------------------------------------
Private Form_directorychooser As FDirectoryChooser
Private bDataChanged As Boolean
Private bExit As Boolean

Public Sub Form_Open()
   
  Init() 
   
End

Public Sub Init()
   bExit = True   
   Try txtLibraryPathLocal.text = modAdminDBI.Config_Get_Staff_Member("library_directory_local", "", Null, modDBConnect.currentUser!fk_clinic, modDBConnect.currentUser!fk_staff) 
   Try txtLibraryHomePage.text = modAdminDBI.Config_Get_Staff_Member("library_default_home_page", "", Null, modDBConnect.currentUser!fk_clinic, modDBConnect.currentUser!fk_staff) 
   bExit = False  
End

Public Sub Save()
   If bDataChanged Then
      modAdminDBI.Config_Save_staff_member(modDBConnect.currentUser!fk_clinic, "library_directory_local", Trim(txtLibraryPathLocal.text), modDBConnect.currentUser!fk_staff) 
      modAdminDBI.Config_Save_staff_member(modDBConnect.currentUser!fk_clinic, "library_default_home_page", Trim(txtLibraryHomePage.text), modDBConnect.currentUser!fk_staff) 
      modDBConnect.CommitTrans()
   End If    
End



Public Sub EditArea_Buttons_Click()
   
   ' Form_directorychooser = New FDirectoryChooser(Me)
   ' With Form_directorychooser 
   '    .top = Last.parent.parent.top + Last.parent.height
   '    .tag = txtLibraryPathLocal
   '    .left = Last.parent.Left
   '    .width = txtLibraryPathLocal.Width
   '    
   ' End With
   ' Form_directorychooser.Visible = True  
   ' Form_directorychooser.ShowModal()
   
End

Public Sub EditArea_TextBox_Change()
   If bExit Then Return    
   bDataChanged = True  

End
