' Gambas class file

'
' Copyright (C) 2008-12 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
'-------------------------------------------------------------------------------------
'PURPOSE    Allow user to set their peferences for how the prescribing section behaves
'-------------------------------------------------------------------------------------

Public Sub Init()
   lblMeasure.text = "  Default Prescribing Mode  "
   modEditAreaHelpers.Resize_labels(Vbox_EditArea, lblmeasure)
    Select Case modAdminDBI.Config_Get_Staff_Member("user_prescribing_mode", "brand", Null, modDBConnect.currentUser!fk_clinic, modDBConnect.currentUser!fk_staff) 
      Case "brand"
            rbBrandPrescribing.value = True
      Case "generic"
            rbGenericPrescribing.Value = True   
   End Select
  
   chkAutoCompleteScript.value = modAdminDBI.Config_Get_Staff_Member("user_prescribing_auto_complete_script", True, Null, modDBConnect.currentUser!fk_clinic, modDBConnect.currentUser!fk_staff) 
   
End


Public Sub EditArea_RadioButtons_Click()

    modAdminDBI.Config_Save_staff_member(modDBConnect.currentUser!fk_clinic, "user_prescribing_mode", Last.tag, modDBConnect.currentUser!fk_staff) 

End

Public Sub chkAutoCompleteScript_Click()

    modAdminDBI.Config_Save_staff_member(modDBConnect.currentUser!fk_clinic, "user_prescribing_auto_complete_script", Str(Last.value), modDBConnect.currentUser!fk_staff) 


End
