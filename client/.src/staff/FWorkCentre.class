' Gambas class file

Private Form_Inbox As FInbox
Private Form_TaskManager As FDayBook 'fixme rename this FTaskManager and delete FTaskManager that already exists
Private Const ctab_Inbox As Integer = 0
Private Const cTab_TaskManager As Integer = 1
Private Const cTab_Reports As Integer = 2
Static Private form_workcentre As FWorkCentre       

Public Sub _New()

   Form_Inbox = New FInbox(Vbox_Inbox)
   form_workcentre = Me 
End

Static Public Sub Update_TaskManager()
   
   form_workcentre.TaskManager_Update
   
End

Private Sub TaskManager_Update()
      '----------------------------------------------------------------------------------------------
      'updates the task manager aka FDaybook (stupid name) uptil I delete the original FTaskmanager
      'and rename FDaybook to FTaskManager - make sense? of cours not its rubbish
      'don't know why I names FDaybook so in the first place
      '----------------------------------------------------------------------------------------------
      Form_TaskManager.Reload_Tasks
   
   
End

Public Sub TabStripInbox_Click()

   lblSectionHeading.text = ""
   Select Case Last.Index
      Case cTab_TaskManager
         If IsNull(Form_TaskManager) Then
            With Form_TaskManager = New FDayBook(VBox_TaskManager)
               .HBox_Heading.Visible = False
            End With
         End If
   End Select
End

Public Sub Settings_Save()

   Try Form_Inbox.Settings_Save()
   Try Form_TaskManager.Settings_Save()

End

Public Sub lblSectionHeading_MouseDown()

End
