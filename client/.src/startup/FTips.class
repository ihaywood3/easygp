' Gambas class file
' Copyright (C) 2008,2009 Dr. Richard Terry

' This program is free software: you can redistribute it and/or modify
' it under the terms of the GNU General Public License as published by
' the Free Software Foundation, either version 3 of the License, or
' (at your option) any later version.

' This program is distributed in the hope that it will be useful,
' but WITHOUT ANY WARRANTY; without even the implied warranty of
' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
' GNU General Public License for more details.

' You should have received a copy of the GNU General Public License
' along with this program.  If not, see <http://www.gnu.org/licenses/>.
' Gambas class file Gambas Tips As a template
 
' 
' Static Private $aOrder As New String[]
' 
' Static Private $iTip As Integer
' 
' Static Public Sub Run()
' 
'   Dim hForm As Form
' 
'   hForm = New FTips
'   hForm.ShowModal
' 
' End
' 
' Static Public Sub _init()
' 
'   Dim hFic As File
'   Dim sLig As String
' 
'   Open "tips/tips.en" As #hFic
' 
'   While Not Eof(hFic)
'     Line Input #hFic, sLig
'     If Left$(sLig) = "[" Then
'       $aOrder.Add(Mid$(Trim$(sLig), 2, -1))
'     Endif
'   Wend
' 
' End
' 
' 
' Public Sub Form_Open()
' 
'   txtTip.Background = Me.Background
' 
'   $iTip = Settings["/LastTip", 0]
'   chkShowTip.Value = Settings["/ShowTipOnStartup", True]
' 
'   ShowNextTip
' 
' End
' 
' Private Sub ShowNextTip(Optional bPrev As Boolean)
' 
'   txtTip.RichText = GetNextTip(bPrev)
'   lblTitle.Text = ("Tip of the day") & " #" & CStr($iTip)
' 
' End
' 
' 
' Private Function GetNextTip(Optional bPrev As Boolean) As String
' 
'   Dim iInd As Integer
'   Dim hFile As File
'   Dim sLig As String
'   Dim sTip As String
'   Dim sFile As String
'   Dim sLang As String
'   Dim iPos As Integer
'   Dim iPos2 As Integer
' 
'   If bPrev Then
'     Dec $iTip
'     If $iTip < 1 Then $iTip = 1
'   Else
'     If $iTip >= $aOrder.Count Then
'       $iTip = 1
'     Else
'       Inc $iTip
'     Endif
'   Endif
' 
'   sLang = System.Language
' 
'   sFile = "tips/tips." & sLang
'   If Not Exist(sFile) Then
'     iPos = InStr(sLang, "_")
'     If iPos Then
'       sLang = Left$(sLang, iPos - 1)
'       sFile = "tips/tips." & sLang
'     Endif
'   Endif
'   If Not Exist(sFile) Then
'     sFile = "tips/tips.en"
'   Endif
' 
'   sTip = File.Load(sFile)
'   iPos = InStr(sTip, "[" & $aOrder[$iTip - 1] & "]")
'   If iPos = 0 Then
'     sTip = File.Load("tips/tips.en")
'   Endif
'   iPos = InStr(sTip, "[" & $aOrder[$iTip - 1] & "]")
'   If iPos = 0 Then Return
' 
'   iPos = InStr(sTip, "\n", iPos)
'   If iPos = 0 Then Return
'   Inc iPos
' 
'   iPos2 = InStr(sTip, "\n[", iPos)
'   If iPos2 = 0 Then iPos2 = Len(sTip) + 1
' 
'   Return Mid$(sTip, iPos, iPos2 - iPos)
' 
' Catch
' 
'   Message.Error(("Unable to read tip of the day !") & "\n\n" & Error.Text)
' 
' End
' 
' Public Sub chkShowTip_Click()
' 
'   Settings["/ShowTipOnStartup"] = chkShowTip.Value
' 
' End
' 
' Public Sub btnNext_Click()
' 
'   ShowNextTip
' 
' End
' 
' 
' ' PUBLIC SUB Form_Resize()
' ' 
' '   lblTitle.Width = Max(ME.ClientWidth, 512)
' '   panBottom.Y = ME.ClientH - panBottom.Height - 8
' '   panBottom.W = Max(256, ME.ClientW - 16)
' '   btnClose.X = panBottom.W - btnClose.W
' '   btnNext.X = btnClose.X - btnNext.W - 8
' '   btnPrev.X = btnNext.X - btnPrev.W - 8
' '   chkShowTip.W = btnPrev.X - chkShowTip.X - 8
' ' 
' '   txtTip.Resize(ME.ClientWidth - txtTip.X * 2, ME.ClientH - panBottom.H - txtTip.Y - 8)
' ' 
' ' 
' '   'imgCorner.Move(ME.ClientW - imgCorner.W,ME.ClientH - imgCorner.H)
' ' 
' ' END
' 
' Public Sub btnClose_Click()
' 
'   Settings["/LastTip"] = $iTip
'   Me.Close
' 
' End
' 
' Public Sub btnPrev_Click()
' 
'   ShowNextTip(True)
' 
' End
