' Gambas class file

Private cTab_Pregnancy_calc As Integer = 1
Private cTab_Numeric_Calculator As Integer = 2
Private cTab_Dosage_Calculator As Integer = 3
Private form_pregnancy_calculator As FPregCalc
Private form_numeric_calculator As FCalculator
Private form_bmi_calculator As FBMICalc

Private obs As Observer
Private currentconsult As CConsult

Public Sub _new()
   
   If IsNull(form_bmi_calculator) Then
      form_bmi_calculator = New FBMICalc(HBox_BMI)
   End If 
   
End

Public Sub Init(cons As CConsult)
   
  currentconsult = cons
   
End


Public Sub PregCalc_tbEditArea_Click()
   '----------------------------------------------------------------------
   'Over-rides the tbInsert button click event in the pregnancy calculator
   'to get a summary of the text and insert into the progress notes
   '----------------------------------------------------------------------
   ' 
   ' If IsNull(currentconsult) Then Return
   ' Select Case Last.tag
   '    Case "insert"
   '       FGeneralNotesEditor.teNotes.Insert(".sometext")
   '       FGeneralNotesEditor.teNotes.richtext = Replace$(FGeneralNotesEditor.teNotes.richtext, ".sometext", PregCalc.Dates_Summary_GetRichText())
   '    Case "insert revised"
   '       modUtilGUI.NotImplemented("Inserting revised dates into notes")
   ' End Select
   
End
Public Sub tsCalculators_Click()
   
   Select Case Last.index
      Case cTab_Pregnancy_calc
         If IsNull(form_pregnancy_calculator) Then
            form_pregnancy_calculator = New FPregCalc(HBox_PregCalc)
            obs = New Observer(form_pregnancy_calculator.tbInsert) As "PregCalc_tbEditArea"
            obs = New Observer(form_pregnancy_calculator.tbInsertRevised) As "PregCalc_tbEditArea"
         End If
      Case cTab_Numeric_Calculator
         If IsNull(form_numeric_calculator) Then
            form_numeric_calculator = New FCalculator(HBox_Calculator)
         End If
   End Select
   
End

' Public Sub PregCalc_tbEditArea_Click()
'    '----------------------------------------------------------------------
'    'Over-rides the tbInsert button click event in the pregnancy calculator
'    'to get a summary of the text and insert into the progress notes
'    '----------------------------------------------------------------------
'    
'    If IsNull(currentconsult) Then Return
'    Select Case Last.tag
'       Case "insert"
'       '    FGeneralNotesEditor.teNotes.Insert(".sometext")
'       '    FGeneralNotesEditor.teNotes.richtext = Replace$(FGeneralNotesEditor.teNotes.richtext, ".sometext", PregCalc.Dates_Summary_GetRichText())
'        Case "insert revised"
'          modUtilGUI.NotImplemented("Inserting revised dates into notes")
'    End Select
'    
' End
